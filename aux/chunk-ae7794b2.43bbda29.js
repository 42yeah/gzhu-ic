(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ae7794b2"],{"0487":function(e,t,n){"use strict";n("4614")},"06c5":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n("6b75");function i(e,t){if(e){if("string"===typeof e)return Object(a["a"])(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(a["a"])(e,t):void 0}}},"0972":function(e,t,n){},"0bc8":function(e,t,n){},"1c4c":function(e,t,n){"use strict";var a=n("9b43"),i=n("5ca1"),s=n("4bf8"),r=n("1fa8"),o=n("33a4"),l=n("9def"),c=n("f1ae"),m=n("27ee");i(i.S+i.F*!n("5cc5")((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,i,u,d=s(e),h="function"==typeof this?this:Array,f=arguments.length,p=f>1?arguments[1]:void 0,v=void 0!==p,g=0,_=m(d);if(v&&(p=a(p,f>2?arguments[2]:void 0,2)),void 0==_||h==Array&&o(_))for(t=l(d.length),n=new h(t);t>g;g++)c(n,g,v?p(d[g],g):d[g]);else for(u=_.call(d),n=new h;!(i=u.next()).done;g++)c(n,g,v?r(u,p,[i.value,g],!0):i.value);return n.length=g,n}})},"25a6":function(e,t,n){"use strict";n("c0ab")},2909:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n("6b75");function i(e){if(Array.isArray(e))return Object(a["a"])(e)}function s(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var r=n("06c5");function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e){return i(e)||s(e)||Object(r["a"])(e)||o()}},"2ae2":function(e,t,n){"use strict";n("d56d")},"2de5":function(e,t,n){},"37c8":function(e,t,n){t.f=n("2b4c")},"3a56e":function(e,t,n){"use strict";var a=n("2909");n("7f7f"),n("7514"),n("ac6a");function i(e,t,n){if(Array.isArray(e)){var a=null;return e.forEach((function(e){e.children&&e.children.forEach((function(e){if(e.children){var i=e.children.find((function(e){return e[t]==n}));i&&(a=i)}else e[t]==n&&(a=e)}))})),a}}function s(e,t){if(Array.isArray(e))return e.reduce((function(e,n){return n.children?(t=t||"",e.push.apply(e,Object(a["a"])(s(n.children,t?"".concat(t," / ").concat(n.name):n.name)))):(n.title="".concat(t," / ").concat(n.name),e.push(n)),e}),[])}var r={methods:{getDefault:function(e,t,n,a){var s=i(e,n,a);return s?s[t]:""},getDefaultArea:function(e,t,n){return i(e,t,n)},getAllArea:function(e){var t=s(e);return JSON.parse(JSON.stringify(t))}}};t["a"]=r},"3a72":function(e,t,n){var a=n("7726"),i=n("8378"),s=n("2d00"),r=n("37c8"),o=n("86cc").f;e.exports=function(e){var t=i.Symbol||(i.Symbol=s?{}:a.Symbol||{});"_"==e.charAt(0)||e in t||o(t,e,{value:r.f(e)})}},"3b8d":function(e,t,n){"use strict";n("0bc8")},4614:function(e,t,n){},4851:function(e,t,n){"use strict";n("8072")},"4ccf":function(e,t,n){"use strict";var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"day_info"},[e.areaName?t("h3",{staticClass:"areaname"},[e._v(e._s(e.areaName))]):e._e(),e.ruleOne.length>0||e.ruleTwo.length>0||e.ruleThree.length>0?t("div",{staticClass:"pane"},[t("div",{staticClass:"fw500"},[e._v("每周开放日")]),e._l(e.ruleOne,(function(n,a){return t("span",{key:"".concat(n.firstTime[0],"_").concat(a),staticClass:"pane-block"},[t("span",{staticClass:"mr10"},[e._v(e._s(e._f("filterDw")(n.dayOfWeek,e.weekOption,e.isArray)))]),t("span",[e._v(e._s("".concat(n.firstTime[0]," - ").concat(n.firstTime[1])))])])})),e._l(e.ruleTwo,(function(n,a){return t("span",{key:"".concat(n.firstTime[0]).concat(n.secondTime[0],"_").concat(a),staticClass:"pane-block"},[t("span",{staticClass:"mr10"},[e._v(e._s(e._f("filterDw")(n.dayOfWeek,e.weekOption,e.isArray)))]),t("span",[e._v(e._s("".concat(n.firstTime[0]," - ").concat(n.firstTime[1],", ").concat(n.secondTime[0]," - ").concat(n.secondTime[1])))])])})),e._l(e.ruleThree,(function(n,a){return t("span",{key:"".concat(n.firstTime[0]).concat(n.secondTime[0]).concat(n.thirdTime[0],"_").concat(a),staticClass:"pane-block"},[t("span",{staticClass:"mr10"},[e._v(e._s(e._f("filterDw")(n.dayOfWeek,e.weekOption,e.isArray)))]),t("span",[e._v(e._s("".concat(n.firstTime[0]," - ").concat(n.firstTime[1],", ").concat(n.secondTime[0]," - ").concat(n.secondTime[1],", ").concat(n.thirdTime[0]," - ").concat(n.thirdTime[1])))])])}))],2):e._e()])},i=[],s=(n("7514"),n("6b54"),n("a481"),n("28a5"),n("55dd"),n("5df3"),n("1c4c"),n("456d"),n("ac6a"),{name:"DayInfo",props:{areaName:{type:String,default:""},areaRules:{type:[Array,Object],required:!0}},data:function(){return this.weekOption=["星期一","星期二","星期三","星期四","星期五","星期六","星期日"],{ruleOne:[],ruleTwo:[],ruleThree:[]}},watch:{areaRules:{handler:function(e){var t=this,n=JSON.parse(JSON.stringify(e));if(this.isArray(n)){var a=[],i=[],s=[];n.forEach((function(e){var t=Object.keys(e),n=t.length;1===n-1?a.push(e):2===n-1?i.push(e):3===n-1&&s.push(e)})),this.ruleOne=this.mergeItem(a,(function(e){return function(n){return t.cmpArray(n.firstTime,e.firstTime)}})),this.ruleTwo=this.mergeItem(i,(function(e){return function(n){return t.cmpArray(n.firstTime,e.firstTime)&&t.cmpArray(n.secondTime,e.secondTime)}})),this.ruleThree=this.mergeItem(s,(function(e){return function(n){return t.cmpArray(n.firstTime,e.firstTime)&&t.cmpArray(n.secondTime,e.secondTime)&&t.cmpArray(n.thirdTime,e.thirdTime)}}))}},immediate:!0}},computed:{isShowSpecial:function(){return this.areaRules.special&&Array.isArray(this.areaRules.special)&&this.areaRules.special.length>0}},filters:{filterDw:function(e,t,n){if(n(e)){var a,i,s=Array.from(e);if(s.sort(),s.length>=3)s=s.reduce((function(e,t,n,r){return 0===n?(e.push(t),a=i=0):t-s[n-1]===1?(i=n,i===r.length-1&&e.push("".concat(e.pop(),"-").concat(r[i]))):t-s[n-1]>1&&(i-a>=2&&e.push("".concat(e.pop(),"-").concat(r[i])),e.push(t),a=i=n),e}),[]);var r=s.reduce((function(e,n,a){if("string"===typeof n){var i=n.split("-");return i.length>1?e.concat("".concat(t[i[0]]," 至 ").concat(t[i[1]])):e.concat("".concat(t[n],"，"))}return e.concat("".concat(t[n],"，"))}),"");return r.replace(/，$/,"")}return t[e]}},methods:{isObject:function(e){return null!==e&&"Object"===Object.prototype.toString.call(e).slice(8,-1)},isArray:function(e){return null!==e&&Array.isArray(e)},objForEach:function(e,t){if(this.isObject(e))for(var n=0,a=Object.keys(e);n<a.length;n++){var i=a[n];e.hasOweProperty(i)&&t(e[i])}},cmpArray:function(e,t){return e.length===t.length&&!!e.every((function(e,n){return e===t[n]}))},mergeItem:function(e,t){var n=this;return e.reduce((function(e,a,i){if(0===i)e.push(a);else{var s=e.find(t(a));if(s)if(n.isArray(s.dayOfWeek))s.dayOfWeek.push(a.dayOfWeek);else{var r=s.dayOfWeek;n.$set(s,"dayOfWeek",[r,a.dayOfWeek])}else e.push(a)}return e}),[])}}}),r=s,o=(n("3b8d"),n("2877")),l=Object(o["a"])(r,a,i,!1,null,"28027c4c",null);t["a"]=l.exports},5063:function(e,t,n){"use strict";var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"researchInfo"},[t("h3",{staticClass:"title cl"},[e._v(e._s(e.$t("index_main_resvInfo_title")))]),e.isWeek?t("main",{staticClass:"main"},[e.roomInfo.resvRule&&e.roomInfo.resvRule.cancelTime?t("p",{staticClass:"main-line"},[e._m(0),e._v("\r\n        "+e._s(e.$t("index_main_resvInfo_cancelTime_label1"))+"\r\n        "),t("span",{staticClass:"content cl"},[e.isZju?t("span",[e._v(e._s(e.roomInfo.resvRule?e.roomInfo.resvRule.cancelTime-2:0)+e._s(e.$t("common_unit_m")))]):t("span",[e._v(e._s(e.roomInfo.resvRule?e.roomInfo.resvRule.cancelTime:0)+e._s(e.$t("common_unit_m")))])]),e._v("\r\n        "+e._s(e.$t("index_main_resvInfo_cancelTime_label2"))+"\r\n      ")]):e._e()]):t("main",{staticClass:"main"},[t("p",{staticClass:"main-line"},[e._m(1),e._v("\r\n        "+e._s(e.$t("index_main_resvInfo_openLabel"))+":\r\n        "),t("span",{staticClass:"content cl"},e._l(e.roomInfo.openTimes,(function(n,a){return t("span",{key:a},[e._v(e._s(n.openStartTime)+"--"+e._s(n.openEndTime)+"  ")])})),0)]),t("p",{staticClass:"main-line"},[e._m(2),e._v("\r\n        "+e._s(e.$t("index_main_resvInfo_advanceResvLabel"))+":\r\n        "),t("span",{staticClass:"content cl"},[0==e.roomInfo.resvRule.latestResvTime&&0==e.roomInfo.resvRule.earliestResvTime?t("span",[e._v("当天")]):e.roomInfo.resvRule&&0!==e.roomInfo.resvRule.latestResvTime?t("span",[e.latestResvTime.d?t("span",[e._v(e._s(e.latestResvTime.d)+e._s(e.$t("common_unit_d"))+"\r\n            ")]):e._e(),e.latestResvTime.h?t("span",[e._v(e._s(e.latestResvTime.h)+e._s(e.$t("common_unit_h"))+"\r\n            ")]):e._e(),e.latestResvTime.m?t("span",[e._v(e._s(e.latestResvTime.m)+e._s(e.$t("common_unit_m")))]):e._e()]):t("span",[e._v("0-")]),e.earliestResvTime.d?t("span",[e._v(e._s(e.earliestResvTime.d)+e._s(e.$t("common_unit_d"))+"\r\n          ")]):e._e(),e.earliestResvTime.h?t("span",[e._v(e._s(e.earliestResvTime.h)+e._s(e.$t("common_unit_h"))+"\r\n          ")]):e._e(),e.earliestResvTime.m?t("span",[e._v(e._s(e.earliestResvTime.m)+e._s(e.$t("common_unit_m")))]):e._e()])]),t("p",{staticClass:"main-line"},[e._m(3),e._v("\r\n        "+e._s(e.$t("index_main_resvInfo_duration"))+":\r\n        "),t("span",{staticClass:"content cl"},[t("span",[e._v(e._s(e.roomInfo.resvRule&&e.roomInfo.resvRule.minResvTime||0)+e._s(e.$t("common_unit_m"))+"-"+e._s(e.roomInfo.resvRule&&e.roomInfo.resvRule.maxResvTime||0)+e._s(e.$t("common_unit_m")))])])]),e.roomInfo.resvRule&&e.roomInfo.resvRule.cancelTime?t("p",{staticClass:"main-line"},[e._m(4),e._v("\r\n        "+e._s(e.$t("index_main_resvInfo_cancelTime_label1"))+"\r\n        "),t("span",{staticClass:"content cl"},[e.isZju?t("span",[e._v(e._s(e.roomInfo.resvRule?e.roomInfo.resvRule.cancelTime-2:0)+e._s(e.$t("common_unit_m")))]):t("span",[e._v(e._s(e.roomInfo.resvRule?e.roomInfo.resvRule.cancelTime:0)+e._s(e.$t("common_unit_m")))])]),e._v("\r\n        "+e._s(e.$t("index_main_resvInfo_cancelTime_label2"))+"\r\n      ")]):e._e(),t("p",{directives:[{name:"show",rawName:"v-show",value:e.showPerLimit,expression:"showPerLimit"}],staticClass:"main-line"},[e._m(5),e._v("\r\n        "+e._s(e.$t("index_main_resvInfo_numberLimit"))+":\r\n        "),t("span",{staticClass:"content cl"},[t("span",[e._v(e._s(e.roomInfo.minUser)+"-"+e._s(e.roomInfo.maxUser))])])]),e.limit?t("p",{staticClass:"main-line"},[t("span",{staticClass:"seq cl"},[t("span",{staticClass:"seqtxt"},[e._v(e._s(e.showPerLimit?"6":"5"))])]),e._v("\r\n        "+e._s(e.$t("index_main_resvInfo_resvAttrs"))+":\r\n        "),t("span",[e._v(e._s(e.limit))]),2&e.openLimit?t("span",[e._v(e._s(e.$t("index_main_resvInfo_noFreeTimes")))]):e._e()]):e._e()])])},i=[function(){var e=this,t=e._self._c;return t("span",{staticClass:"seq cl"},[t("span",{staticClass:"seqtxt"},[e._v("1")])])},function(){var e=this,t=e._self._c;return t("span",{staticClass:"seq cl"},[t("span",{staticClass:"seqtxt"},[e._v("1")])])},function(){var e=this,t=e._self._c;return t("span",{staticClass:"seq cl"},[t("span",{staticClass:"seqtxt"},[e._v("2")])])},function(){var e=this,t=e._self._c;return t("span",{staticClass:"seq cl"},[t("span",{staticClass:"seqtxt"},[e._v("3")])])},function(){var e=this,t=e._self._c;return t("span",{staticClass:"seq cl"},[t("span",{staticClass:"seqtxt"},[e._v("4")])])},function(){var e=this,t=e._self._c;return t("span",{staticClass:"seq cl"},[t("span",{staticClass:"seqtxt"},[e._v("5")])])}],s=(n("ac6a"),{props:{roomInfo:{type:Object,required:!0},showPerLimit:{type:Boolean,default:!0},isWeek:{type:Boolean,default:!1}},computed:{openLimit:function(){return this.roomInfo.openTimes.length>0?this.roomInfo.openTimes[0].openLimit:1},limit:function(){if(!this.roomInfo.resvRule)return"";var e=this.roomInfo.resvRule.limit,t=[{value:0,label:this.$t("index_main_resvInfo_limit_label1")},{value:1,label:this.$t("index_main_resvInfo_limit_label2")},{value:2,label:this.$t("index_main_resvInfo_limit_label3")},{value:8,label:this.$t("index_main_resvInfo_limit_label5")},{label:this.$t("index_main_resvInfo_limit_label6"),value:16},{label:this.$t("index_main_resvInfo_limit_label9"),value:32},{label:this.$t("index_main_resvInfo_limit_label7"),value:64},{label:this.$t("index_main_resvInfo_limit_label8"),value:128}];if(0!=e){var n=t.filter((function(t){return(t.value&e)>0})),a="";return n.forEach((function(e){a+="".concat(e.label,"; ")})),a}return this.$t("index_main_resvInfo_limit_label1")},earliestResvTime:function(){var e={d:"",h:"",m:""};return this.roomInfo.resvRule&&(e.d=Math.floor(this.roomInfo.resvRule.earliestResvTime/1440),e.h=Math.floor(this.roomInfo.resvRule.earliestResvTime%1440/60),e.m=Math.floor(this.roomInfo.resvRule.earliestResvTime%1440%60)),e},latestResvTime:function(){var e={d:"",h:"",m:""};return this.roomInfo.resvRule&&(e.d=Math.floor(this.roomInfo.resvRule.latestResvTime/1440),e.h=Math.floor(this.roomInfo.resvRule.latestResvTime%1440/60),e.m=Math.floor(this.roomInfo.resvRule.latestResvTime%1440%60)),e}}}),r=s,o=(n("4851"),n("2877")),l=Object(o["a"])(r,a,i,!1,null,"6a15c76b",null);t["a"]=l.exports},5648:function(e,t,n){"use strict";n("b980")},"5df3":function(e,t,n){"use strict";var a=n("02f4")(!0);n("01f9")(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=a(t,n),this._i+=e.length,{value:e,done:!1})}))},"602c":function(e,t,n){},"67ab":function(e,t,n){var a=n("ca5a")("meta"),i=n("d3f4"),s=n("69a8"),r=n("86cc").f,o=0,l=Object.isExtensible||function(){return!0},c=!n("79e5")((function(){return l(Object.preventExtensions({}))})),m=function(e){r(e,a,{value:{i:"O"+ ++o,w:{}}})},u=function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!s(e,a)){if(!l(e))return"F";if(!t)return"E";m(e)}return e[a].i},d=function(e,t){if(!s(e,a)){if(!l(e))return!0;if(!t)return!1;m(e)}return e[a].w},h=function(e){return c&&f.NEED&&l(e)&&!s(e,a)&&m(e),e},f=e.exports={KEY:a,NEED:!1,fastKey:u,getWeak:d,onFreeze:h}},"699a":function(e,t,n){"use strict";n("0972")},"6b75":function(e,t,n){"use strict";function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}n.d(t,"a",(function(){return a}))},7906:function(e,t,n){"use strict";n("7aa4")},"79ae":function(e,t,n){"use strict";n("8b49")},"7aa4":function(e,t,n){},"7bbc":function(e,t,n){var a=n("6821"),i=n("9093").f,s={}.toString,r="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],o=function(e){try{return i(e)}catch(t){return r.slice()}};e.exports.f=function(e){return r&&"[object Window]"==s.call(e)?o(e):i(a(e))}},"7d13":function(e,t,n){"use strict";n.d(t,"h",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"k",(function(){return c})),n.d(t,"l",(function(){return u})),n.d(t,"j",(function(){return h})),n.d(t,"d",(function(){return p})),n.d(t,"g",(function(){return g})),n.d(t,"f",(function(){return y})),n.d(t,"e",(function(){return T})),n.d(t,"a",(function(){return D})),n.d(t,"b",(function(){return O})),n.d(t,"i",(function(){return Y}));n("96cf");var a=n("1da1"),i=n("b480");n("4be7");function s(e){return r.apply(this,arguments)}function r(){return r=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["a"])({method:"get",url:"reserve",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),r.apply(this,arguments)}function o(e){return l.apply(this,arguments)}function l(){return l=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["a"])({method:"get",url:"reserve/areaInfo",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}function c(e){return m.apply(this,arguments)}function m(){return m=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["a"])({method:"post",url:"seatDevice/coordinate",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),m.apply(this,arguments)}function u(e){return d.apply(this,arguments)}function d(){return d=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["a"])({method:"post",url:"digitalReadingPcRoom/coordinate",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}function h(e){return f.apply(this,arguments)}function f(){return f=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["a"])({method:"post",url:"reserve",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),f.apply(this,arguments)}function p(e){return v.apply(this,arguments)}function v(){return v=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["a"])({method:"get",url:"sysInfo",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),v.apply(this,arguments)}function g(e){return _.apply(this,arguments)}function _(){return _=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["a"])({method:"get",url:"seatRoom/openScope",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),_.apply(this,arguments)}function y(e){return b.apply(this,arguments)}function b(){return b=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["a"])({method:"get",url:"seatRoom/open",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),b.apply(this,arguments)}function T(e){return S.apply(this,arguments)}function S(){return S=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["a"])({method:"get",url:"psgSeat/open",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),S.apply(this,arguments)}function D(e){return w.apply(this,arguments)}function w(){return w=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["a"])({method:"get",url:"codingTable/getAll",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),w.apply(this,arguments)}function O(e){return I.apply(this,arguments)}function I(){return I=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["a"])({method:"get",url:"device/tips",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),I.apply(this,arguments)}function Y(e){return $.apply(this,arguments)}function $(){return $=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["a"])({method:"get",url:"/seatDevice/tempLeave",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),$.apply(this,arguments)}},8072:function(e,t,n){},"8a81":function(e,t,n){"use strict";var a=n("7726"),i=n("69a8"),s=n("9e1e"),r=n("5ca1"),o=n("2aba"),l=n("67ab").KEY,c=n("79e5"),m=n("5537"),u=n("7f20"),d=n("ca5a"),h=n("2b4c"),f=n("37c8"),p=n("3a72"),v=n("d4c0"),g=n("1169"),_=n("cb7c"),y=n("d3f4"),b=n("4bf8"),T=n("6821"),S=n("6a99"),D=n("4630"),w=n("2aeb"),O=n("7bbc"),I=n("11e9"),Y=n("2621"),$=n("86cc"),x=n("0d58"),A=I.f,k=$.f,M=O.f,C=a.Symbol,j=a.JSON,R=j&&j.stringify,E="prototype",P=h("_hidden"),H=h("toPrimitive"),N={}.propertyIsEnumerable,F=m("symbol-registry"),V=m("symbols"),L=m("op-symbols"),z=Object[E],B="function"==typeof C&&!!Y.f,W=a.QObject,K=!W||!W[E]||!W[E].findChild,U=s&&c((function(){return 7!=w(k({},"a",{get:function(){return k(this,"a",{value:7}).a}})).a}))?function(e,t,n){var a=A(z,t);a&&delete z[t],k(e,t,n),a&&e!==z&&k(z,t,a)}:k,q=function(e){var t=V[e]=w(C[E]);return t._k=e,t},X=B&&"symbol"==typeof C.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof C},G=function(e,t,n){return e===z&&G(L,t,n),_(e),t=S(t,!0),_(n),i(V,t)?(n.enumerable?(i(e,P)&&e[P][t]&&(e[P][t]=!1),n=w(n,{enumerable:D(0,!1)})):(i(e,P)||k(e,P,D(1,{})),e[P][t]=!0),U(e,t,n)):k(e,t,n)},J=function(e,t){_(e);var n,a=v(t=T(t)),i=0,s=a.length;while(s>i)G(e,n=a[i++],t[n]);return e},Z=function(e,t){return void 0===t?w(e):J(w(e),t)},Q=function(e){var t=N.call(this,e=S(e,!0));return!(this===z&&i(V,e)&&!i(L,e))&&(!(t||!i(this,e)||!i(V,e)||i(this,P)&&this[P][e])||t)},ee=function(e,t){if(e=T(e),t=S(t,!0),e!==z||!i(V,t)||i(L,t)){var n=A(e,t);return!n||!i(V,t)||i(e,P)&&e[P][t]||(n.enumerable=!0),n}},te=function(e){var t,n=M(T(e)),a=[],s=0;while(n.length>s)i(V,t=n[s++])||t==P||t==l||a.push(t);return a},ne=function(e){var t,n=e===z,a=M(n?L:T(e)),s=[],r=0;while(a.length>r)!i(V,t=a[r++])||n&&!i(z,t)||s.push(V[t]);return s};B||(C=function(){if(this instanceof C)throw TypeError("Symbol is not a constructor!");var e=d(arguments.length>0?arguments[0]:void 0),t=function(n){this===z&&t.call(L,n),i(this,P)&&i(this[P],e)&&(this[P][e]=!1),U(this,e,D(1,n))};return s&&K&&U(z,e,{configurable:!0,set:t}),q(e)},o(C[E],"toString",(function(){return this._k})),I.f=ee,$.f=G,n("9093").f=O.f=te,n("52a7").f=Q,Y.f=ne,s&&!n("2d00")&&o(z,"propertyIsEnumerable",Q,!0),f.f=function(e){return q(h(e))}),r(r.G+r.W+r.F*!B,{Symbol:C});for(var ae="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ie=0;ae.length>ie;)h(ae[ie++]);for(var se=x(h.store),re=0;se.length>re;)p(se[re++]);r(r.S+r.F*!B,"Symbol",{for:function(e){return i(F,e+="")?F[e]:F[e]=C(e)},keyFor:function(e){if(!X(e))throw TypeError(e+" is not a symbol!");for(var t in F)if(F[t]===e)return t},useSetter:function(){K=!0},useSimple:function(){K=!1}}),r(r.S+r.F*!B,"Object",{create:Z,defineProperty:G,defineProperties:J,getOwnPropertyDescriptor:ee,getOwnPropertyNames:te,getOwnPropertySymbols:ne});var oe=c((function(){Y.f(1)}));r(r.S+r.F*oe,"Object",{getOwnPropertySymbols:function(e){return Y.f(b(e))}}),j&&r(r.S+r.F*(!B||c((function(){var e=C();return"[null]"!=R([e])||"{}"!=R({a:e})||"{}"!=R(Object(e))}))),"JSON",{stringify:function(e){var t,n,a=[e],i=1;while(arguments.length>i)a.push(arguments[i++]);if(n=t=a[1],(y(t)||void 0!==e)&&!X(e))return g(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!X(t))return t}),a[1]=t,R.apply(j,a)}}),C[E][H]||n("32e9")(C[E],H,C[E].valueOf),u(C,"Symbol"),u(Math,"Math",!0),u(a.JSON,"JSON",!0)},"8b49":function(e,t,n){},"90d4":function(e,t,n){"use strict";n("7f7f"),n("6b54");var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"day_info"},[e.areaName?t("h3",{staticClass:"areaname"},[e._v(e._s(e.areaName))]):e._e(),e.isShowSpecial?t("div",{staticClass:"pane"},[t("div",{staticClass:"fw500"},[e._v("特殊日期（开放）: ")]),e._l(e.areaRules.special,(function(n,a){return t("span",{key:"".concat(n.startDay,"_").concat(a),staticClass:"pane-block"},[e._v("\r\n        "+e._s("".concat(a+1,". ").concat(e.$moment(n.startDay.toString()).format("YYYY-MM-DD")," 至 ").concat(e.$moment(n.endDay.toString()).format("YYYY-MM-DD")))+"\r\n      ")])}))],2):e._e(),e.localeWeek.length>0?t("div",{staticClass:"pane"},[t("div",{staticClass:"fw500"},[e._v("每周开放日")]),e._l(e.localeWeek,(function(n){return t("span",{key:n,staticClass:"pane-block"},[t("span",{directives:[{name:"show",rawName:"v-show",value:0===n,expression:"wk===0"}]},[e._v("星期一")]),t("span",{directives:[{name:"show",rawName:"v-show",value:1===n,expression:"wk===1"}]},[e._v("星期二")]),t("span",{directives:[{name:"show",rawName:"v-show",value:2===n,expression:"wk===2"}]},[e._v("星期三")]),t("span",{directives:[{name:"show",rawName:"v-show",value:3===n,expression:"wk===3"}]},[e._v("星期四")]),t("span",{directives:[{name:"show",rawName:"v-show",value:4===n,expression:"wk===4"}]},[e._v("星期五")]),t("span",{directives:[{name:"show",rawName:"v-show",value:5===n,expression:"wk===5"}]},[e._v("星期六")]),t("span",{directives:[{name:"show",rawName:"v-show",value:6===n,expression:"wk===6"}]},[e._v("星期日")])])}))],2):e._e(),e.areaRules.holiday&&Array.isArray(e.areaRules.holiday)&&e.areaRules.holiday.length>0?t("div",{staticClass:"pane"},[t("div",{staticClass:"fw600"},[e._v("节假日（不开放）: ")]),e._l(e.areaRules.holiday,(function(n,a){return t("span",{key:"".concat(n.startDay,"_").concat(a),staticClass:"pane-block"},[e._v("\r\n        "+e._s("".concat(a+1,".").concat(n.name,": ").concat(e.$moment(n.startDay.toString()).format("YYYY-MM-DD")," 至 ").concat(e.$moment(n.endDay.toString()).format("YYYY-MM-DD")))+"\r\n      ")])}))],2):e._e()])},i=[],s=(n("55dd"),{name:"DayInfo",props:{areaName:{type:String,default:""},areaRules:{type:Object,required:!0}},computed:{isShowSpecial:function(){return this.areaRules.special&&Array.isArray(this.areaRules.special)&&this.areaRules.special.length>0},localeWeek:function(){return this.areaRules&&this.areaRules.week&&Array.isArray(this.areaRules.week)?this.areaRules.week.sort():[]}}}),r=s,o=(n("2ae2"),n("2877")),l=Object(o["a"])(r,a,i,!1,null,"150fa7b4",null);t["a"]=l.exports},"9cf8":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"seat"},[!e.isSpanDay&&e.areaRules&&Array.isArray(e.areaRules)?[t("DayTimeInfo",{attrs:{areaRules:e.areaRules,areaName:e.areaName}})]:e.isSpanDay&&e.acrossAreaRules?[t("DayInfo",{attrs:{areaRules:e.acrossAreaRules,areaName:e.areaName}})]:e._e(),t("div",{staticClass:"content"},[t("SeatIntroduce",{attrs:{areaName:e.areaName}})],1),t("MyTabs",{attrs:{tabList:e.tabList,currentIndex:e.currentIndex},on:{changeTab:e.changeTab}},[0==e.currentIndex?[e.isSpanDay?[t("SeatAcrossReserve")]:[t("SeatReserve")]]:1==e.currentIndex?t("ImgList"):e._e()],2)],2)},i=[],s=(n("8e6e"),n("ac6a"),n("456d"),n("7f7f"),n("ade3")),r=n("7d13"),o=function(){var e=this,t=e._self._c;return t("div",[e.isEdit?[t("EditSeat",{directives:[{name:"loading",rawName:"v-loading",value:e.editLoading,expression:"editLoading"}],attrs:{seatOptions:e.editOptions},on:{cancel:e.handleEditFalse,save:e.getSeatPosition}})]:[t("section",{staticClass:"seatOperation"},[t("el-date-picker",{attrs:{type:"date",size:"small",placeholder:"选择日期",clearable:!1,"picker-options":e.pickerOptions},on:{change:e.handleDatePickerChange},model:{value:e.dateValue,callback:function(t){e.dateValue=t},expression:"dateValue"}}),t("span",{staticClass:"time-container"},[e.isNotFreely?t("el-select",{staticClass:"not-free",attrs:{size:"small",placeholder:e.$t("common_select_placeholder")},on:{change:e.handleNotFreeTimeChange},model:{value:e.noFreeSelectTime,callback:function(t){e.noFreeSelectTime=t},expression:"noFreeSelectTime"}},e._l(e.notFreeTimeArr,(function(e,n){return t("el-option",{key:n,attrs:{label:e.value,value:e.value}})})),1):[e.judgLimit(e.options[0],64)?t("span",[e.isOpen(e.options[0],e.dateValue)?t("span",[e._v("\r\n                "+e._s(e.$t("index_main_seatForm_currentTime"))+"\r\n              ")]):t("span",[e._v("\r\n                "+e._s(e.openStart)+"\r\n              ")])]):t("el-select",{staticClass:"w120",attrs:{size:"small",placeholder:"开始时间"},on:{change:e.handleSltSTChange},model:{value:e.startTimeStr,callback:function(t){e.startTimeStr=t},expression:"startTimeStr"}},e._l(e.startTimeOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.value,value:e.value}})})),1),e._v("\r\n            "+e._s(e.$t("common_dateTime_seq"))+"\r\n            "),e.isJudgLimit&&e.judgLimit(e.options[0],64)?t("span",[e._v("\r\n              "+e._s(e.closeTime)+"\r\n            ")]):t("el-select",{staticClass:"w120",attrs:{size:"small",placeholder:"结束时间"},on:{change:e.handleSltETChange},model:{value:e.endTimeStr,callback:function(t){e.endTimeStr=t},expression:"endTimeStr"}},e._l(e.endTimeOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.value,value:e.value}})})),1)]],2),e.isshowedit?t("el-button",{style:{"margin-left":"10px"},attrs:{size:"small"},on:{click:e.handleEditTrue}},[e._v(e._s(e.$t("index_main_seat_editPane_edit")))]):e._e(),t("div",{staticStyle:{"margin-top":"10px",display:"flex","align-items":"center"}},[e.allSeatProperties.length>0&&!e.isEdit?t("div",{staticStyle:{display:"flex","align-items":"center"}},[t("span",{staticStyle:{"margin-right":"20px"}},[e._v("选择座位:")]),t("el-checkbox-group",{model:{value:e.checkedProps,callback:function(t){e.checkedProps=t},expression:"checkedProps"}},e._l(e.allSeatProperties,(function(n){return t("el-checkbox",{key:n.codeValue,attrs:{label:n.codeValue}},[e._v(e._s(n.name))])})),1)],1):e._e(),e.isShowSeatLeaving?t("div",{staticStyle:{"margin-left":"40px"}},[t("span",{staticStyle:{"margin-right":"10px"}},[e._v("暂离剩余时长:")]),t("el-select",{attrs:{placeholder:"请选择暂离剩余时长",size:"small",clearable:""},model:{value:e.LeaveTemporarilyStr,callback:function(t){e.LeaveTemporarilyStr=t},expression:"LeaveTemporarilyStr"}},e._l(e.LeaveTemporarilyOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.LeaveTemporarilyStr,value:e.value}})})),1)],1):e._e()])],1),t("div",{staticClass:"status_wrapper"},[t("span",{staticClass:"free"},[e._v(e._s(e.$t("common_seatStatus_free")))]),t("span",{staticClass:"half_free"},[e._v(e._s(e.isJudgLimit?"".concat(e.$t("common_seatStatus_stepOut")):"".concat(e.$t("common_seatStatus_halfFree"))))]),t("span",{staticClass:"busy"},[e._v(e._s(e.$t("common_seatStatus_inUsing")))]),t("span",{staticClass:"noopen"},[e._v(e._s(e.$t("common_seatStatus_noOpen")))]),t("span",{staticClass:"noopenlook"},[e._v("网站不开放但可查看")])]),t("SeatArea",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"seatArea",attrs:{options:e.filteredOptions,isEdit:e.isEdit,circleSizeValue:e.circleSizeValue,isShowMask:e.isShowMask,canDbClick:!1,showName:e.isShowName,modalBeforeCreate:e.modalBeforeCreate,modalCreated:e.modalCreated,dateValue:e.dateValue},on:{handleClickItem:e.handleClickItem}})],t("SeatForm",{ref:"seatForm",attrs:{SeatInfo:e.SeatInfo,dateValue:e.dateValue,selectedTimeObj:e.selectedTimeObj},on:{reset:e.handleGetSeat}}),t("NeedKnow",{ref:"needKnow",attrs:{valObj:e.valObj},on:{confirm:e.confirm}})],2)},l=[],c=(n("5df3"),n("1c4c"),n("6762"),n("2fdb"),n("55dd"),n("2909")),m=(n("7514"),n("28a5"),n("20d6"),n("13a8")),u=n("fa7d"),d=n("53ca"),h={data:function(){return{__canSelectTime__:null,__initData__:null}},methods:{isNotFreelySelectTime:function(e){return!(!e||!Array.isArray(e)||e.length<=0)&&(2&e[0].openLimit)>0},initFreeTimeArr:function(e,t){function n(e,t){return{value:e+" - "+t}}function a(e,t,n,a,i){var s=e.$moment().add(a,"m"),r=e.$moment().add(i,"m"),o=[];return n.forEach((function(n){e.$moment("".concat(t," ").concat(n.openStartTime)).isBetween(s,r)&&o.push(n)})),o}this.__initData__=this.formatDisablectData(e,t);var i=t.openTimes;if(i.length<=0)return[];var s=[],r=this.$moment(e).format("YYYY/MM/DD");if(r===this.$moment().format("YYYY/MM/DD")){var o=this.$moment(),l=i.filter((function(e){return new Date("".concat(o.format("YYYY/MM/DD")," ").concat(e.openEndTime))>o}));if(l.length>0){var c=new Date("".concat(o.format("YYYY/MM/DD")," ").concat(l[0].openStartTime))>o?l[0].openStartTime:"当前时间";s.push({start:c,end:l[0].openEndTime})}for(var m=0,u=l.length;m<u-1;m++)s.push({start:l[m+1].openStartTime,end:l[m+1].openEndTime})}else{var d=t.resvInfo,h=d.latestResvTime,f=d.earliestResvTime;if(0!==Math.ceil(f%1440)&&r===this.$moment().add(f,"m").format("YYYY/MM/DD")){this.$moment().add(f,"m");var p=a(this,r,i,h,f);p.forEach((function(e){s.push({start:e.openStartTime,end:e.openEndTime})}))}else for(var v=0,g=i.length;v<g;v++)s.push({start:i[v].openStartTime,end:i[v].openEndTime})}return s=s.map((function(e){return n(e.start,e.end)})),s},returnFreeTime:function(e){var t=e.split("-");return"当前时间"!==t[0].trim()&&"currentTime"!==t[0].trim()||(t[0]=this.$moment().format("HH:mm")),{startTime:t[0].trim(),endTime:t[1].trim()}},getSeatNoOpenTimes:function(e,t){var n=[],a=(t.openStart,t.openEnd,t.openTimes),i=this.$moment("".concat(e," 00:00")),s=this.$moment("".concat(e," 23:59"));"00:00"!=a[0].startTime&&n.push({start:i.format("HH:mm"),end:a[0].openStartTime});for(var r=0,o=a.length;r<o-1;r++)this.$moment("".concat(e," ").concat(a[r].openEndTime)).isBefore(this.$moment("".concat(e," ").concat(a[r+1].openEndTime)))&&n.push({start:a[0].openEndTime,end:a[1].openStartTime});return"23:59"!=a[a.length-1].openEndTime&&n.push({start:a[a.length-1].openEndTime,end:s.format("HH:mm")}),n},handleItemCurrentClass:function(e,t,n){if(!n.resvRule||!n.openTimes)return n.isShow=!1,"gray";if(n.onlyView)return"noopenlook";var a=n.resvInfo,i=(n.resvRule,n.resvRule);i=void 0===i?{}:i;var s=i.earliestResvTime,r=void 0===s?"":s,o=i.latestResvTime,l=void 0===o?"":o,c=n.openEnd,m=(n.openStart,this.$moment(t).format("YYYY/MM/DD"));if(this.$moment(m).isAfter(this.$moment().add(r,"minutes").format("YYYY/MM/DD"))||this.$moment(m).isBefore(this.$moment(this.$moment().add(l,"minutes").format("YYYY/MM/DD")))||this.$moment(m).format("YYYY/MM/DD")===this.$moment().format("YYYY/MM/DD")&&this.$moment().isSameOrAfter(this.$moment("".concat(this.$moment().format("YYYY/MM/DD")," ").concat(c,":00"))))return"gray";var u=this.getCurentTimeStatus(e,a),d="green";switch(u){case 1:d="yellow";break;case 2:d="yellow";break;case 3:d="yellowGreen";break;case 4:d="green";break}return d},getCurentTimeStatus:function(e,t){return Array.isArray(e)&&e.length>1&&Array.isArray(t)&&t.length>0?t.some((function(e){return(2048&e.resvStatus)>0}))?3:1:4},getCurentTimeStatusBak:function(e,t){var n=this;function a(){return n.$moment(i).isSame(n.$moment(),"day")?t.some((function(e){return(4&e.resvStatus)>0&&(64&e.resvStatus)<=0})):Array.isArray(t)&&t.length>0}var i=this.$moment(e).format("YYYY/MM/DD");return a()?1:t.some((function(e){return(64&e.resvStatus)>0&&(128&e.resvStatus)<=0}))?t.some((function(e){return(2048&e.resvStatus)<=0}))?2:3:4},handleItemClass:function(e,t,n,a){var i=this;if(!n.resvRule||!n.openTimes)return n.isShow=!1,"gray";if(n.onlyView)return"noopenlook";var s=this.$moment().format("YYYY/MM/DD");a&&(s=this.$moment(a).format("YYYY/MM/DD")),t=t.map((function(e){return{startTime:"".concat(s," ").concat(i.$moment(e.startTime).format("HH:mm")),endTime:"".concat(s," ").concat(i.$moment(e.endTime).format("HH:mm"))}})),this.$moment().format("YYYY/MM/DD")===s&&t.push({startTime:"".concat(s," 00:00"),endTime:"".concat(s," ").concat(this.$moment().format("HH:mm"))});var r=!1,o="",l=n.resvRule.earliestResvTime;if(l%1440===0)this.$moment(s).isAfter(this.$moment().add(l,"minutes").format("YYYY/MM/DD"))&&(r=!0);else{if(s===this.$moment().add(l,"minutes").format("YYYY/MM/DD")){var c=this.$moment().add(l+n.resvRule.maxResvTime,"minutes");o=c.isSame(s,"day")?c.format("HH:mm"):"".concat(s," 23:59")}this.$moment("".concat(s," ").concat(this.$moment(e[0]).format("HH:mm"))).isAfter(this.$moment().add(l,"minutes"))&&(r=!0)}var m=this.getSeatNoOpenTimes(this.$moment(this.dateValue).format("YYYY/MM/DD"),n),u=!1,d="";n.resvRule.latestResvTime%1440===0&&0!==n.resvRule.latestResvTime?this.$moment(s).isBefore(this.$moment(this.$moment().add(n.resvRule.latestResvTime,"minutes").format("YYYY/MM/DD")))&&(u=!0):(0!==n.resvRule.latestResvTime&&s===this.$moment().add(n.resvRule.latestResvTime,"minutes").format("YYYY/MM/DD")&&(d=this.$moment(this.$moment().add(n.resvRule.latestResvTime,"minutes")).format("HH:mm")),this.$moment("".concat(s," ").concat(this.$moment(e[1]).format("HH:mm"))).isBefore(this.$moment(this.$moment().add(n.resvRule.latestResvTime,"minutes").format("YYYY/MM/DD HH:mm")))&&(u=!0));var h=n.openStart,f=n.openEnd,p=this.$moment(+e[0]).format("HH:mm"),v=this.$moment(+e[1]).format("HH:mm");if("00:00"===p&&m&&+e[1]<+new Date("".concat(s," ").concat(m[0].end))&&"00:00"!==n.resvRule.openTimes[0].openStartTime||"23:59"===v&&"23:59"!==n.openTimes[n.openTimes.length-1].openEndTime&&m&&m.length>0&&+e[0]>+new Date("".concat(s," ").concat(m[m.length-1].start))||m.some((function(t){var n,a;n=e[0]?+e[0]:+new Date,a=e[1]?+e[1]:+new Date;var i=+new Date("".concat(s," ").concat(t.start))<n,r=+new Date("".concat(s," ").concat(t.end))>a;return i&&r}))||r||u||this.$moment("".concat(s," ").concat(f)).isSameOrBefore(this.$moment("".concat(s," ").concat(h))))return"gray";var g=this.$moment(e[1]).format("HH:mm"),_=this.$moment(e[0]).format("HH:mm"),y=this.getSelectedSegTimes(["".concat(s," ").concat(_),"".concat(s," ").concat(g)],t);if(t.some((function(e){return new Date("".concat(s," ").concat(_))-new Date(e.startTime)>=0&&new Date("".concat(s," ").concat(g))-new Date(e.endTime)<=0}))||y.length>0&&y.every((function(e){return i.$moment(e.startTime).add(n.resvRule.minResvTime,"minutes").isAfter(e.endTime)})))return"yellow";var b=!!d&&this.$moment("".concat(s," ").concat(this.$moment(e[0]).format("HH:mm"))).isBefore(this.$moment("".concat(s," ").concat(d))),T=!!o&&this.$moment("".concat(s," ").concat(this.$moment(e[1]).format("HH:mm"))).isAfter(this.$moment("".concat(s," ").concat(o)));if(m.some((function(t){return i.$moment("".concat(s," ").concat(i.$moment(e[0]).format("HH:mm"))).isBetween(i.$moment("".concat(s," ").concat(t.start)),i.$moment("".concat(s," ").concat(t.end)))||i.$moment("".concat(s," ").concat(i.$moment(e[1]).format("HH:mm"))).isBetween(i.$moment("".concat(s," ").concat(t.start)),i.$moment("".concat(s," ").concat(t.end)))}))||b||T)return"yellowGreen";n.resvInfo;return t.every((function(t){return new Date("".concat(s," ").concat(i.$moment(e[1]).format("HH:mm")))-new Date(t.startTime)<=0||new Date("".concat(s," ").concat(i.$moment(e[0]).format("HH:mm")))-new Date(t.endTime)>=0}))?"green":"yellowGreen"},getSelectedSegTimes:function(e,t){var n=this,a=t.reduce((function(t,a,i){var s=a.startTime,r=a.endTime;return n.$moment(e[0]).isBefore(r)&&n.$moment(e[1]).isAfter(s)&&(t.length<=0?n.$moment(e[0]).isBetween(s,r,null,"()")?t.push({startTime:r}):(t.push({startTime:e[0],endTime:s}),n.$moment(e[1]).isAfter(r)&&t.push({startTime:r})):(t[t.length-1].endTime||(t[t.length-1].endTime=s),n.$moment(e[1]).isAfter(r)&&t.push({startTime:r}))),t}),[]);return a.length>0&&!a[a.length-1].endTime&&(a[a.length-1].endTime=e[1]),a},canReserve:function(e,t){if(!t||!t.openTimes||null==Object(d["a"])(t.resvRule.latestResvTime)||null==Object(d["a"])(t.resvRule.earliestResvTime))return!1;var n=t.resvRule,a=n.latestResvTime,i=void 0===a?0:a,s=n.earliestResvTime,r=void 0===s?0:s,o=this.$moment().format("YYYY/MM/DD"),l=this.$moment().add(i,"minutes").format("YYYY/MM/DD");0!=i&&i%1440===0&&(l=this.$moment(o).add(i/1440,"days").format("YYYY/MM/DD"));var c=this.$moment().add(r,"minutes").format("YYYY/MM/DD");r%1440===0&&(c=this.$moment(o).add(r/1440,"days").format("YYYY/MM/DD"));var m=this.$moment(e).format("YYYY/MM/DD");return this.$moment("".concat(m)).isBetween(l,c,null,"[]")},formatDisablectData:function(e,t){var n=this.$moment(e).format("YYYY/MM/DD"),a={startTime:"",endTime:"",disableTime:[]};if(!t.openTimes||!Array.isArray(t.openTimes))return a;if(t.openStart&&(a.startTime=this.$moment(new Date("".concat(n," ").concat(t.openStart))).format("HH:00")),t.openEnd){var i=this.$moment(new Date("".concat(n," ").concat(t.openEnd))).format("HH:00");a.endTime=+new Date("".concat(n," ").concat(i))<+new Date("".concat(n," ").concat(t.openEnd))?this.$moment("".concat(n," ").concat(i)).add(1,"hours").format("HH:00"):i,"00:00"==a.endTime&&(a.endTime="23:59")}if(1===t.openTimes.length){var s=t.openTimes;new Date("".concat(n," ").concat(s[0].openStartTime))-new Date("".concat(n," ").concat(a.startTime))>0&&a.disableTime.push({startTime:this.$moment(new Date("".concat(n," ").concat(a.startTime))).format("YYYY/MM/DD HH:mm"),endTime:this.$moment(new Date("".concat(n," ").concat(s[0].openStartTime))).format("YYYY/MM/DD HH:mm")}),new Date("".concat(n," ").concat(s[s.length-1].openEndTime))-new Date("".concat(n," ").concat(a.endTime))<0&&a.disableTime.push({startTime:this.$moment(new Date("".concat(n," ").concat(s[s.length-1].openEndTime))).format("YYYY/MM/DD HH:mm"),endTime:this.$moment(new Date("".concat(n," ").concat(a.endTime))).format("YYYY/MM/DD HH:mm")})}else{var r=t.openTimes;new Date("".concat(n," ").concat(r[0].openStartTime))-new Date("".concat(n," ").concat(a.startTime))>0&&a.disableTime.push({startTime:this.$moment(new Date("".concat(n," ").concat(a.startTime))).format("YYYY/MM/DD HH:mm"),endTime:this.$moment(new Date("".concat(n," ").concat(r[0].openStartTime))).format("YYYY/MM/DD HH:mm")});for(var o=0;o<r.length-1;o++)a.disableTime.push({startTime:this.$moment(new Date("".concat(n," ").concat(r[o].openEndTime))).format("YYYY/MM/DD HH:mm"),endTime:this.$moment(new Date("".concat(n," ").concat(r[o+1].openStartTime))).format("YYYY/MM/DD HH:mm")});new Date("".concat(n," ").concat(r[r.length-1].openEndTime))-new Date("".concat(n," ").concat(a.endTime))<0&&a.disableTime.push({startTime:this.$moment(new Date("".concat(n," ").concat(r[r.length-1].openEndTime))).format("YYYY/MM/DD HH:mm"),endTime:this.$moment(new Date("".concat(n," ").concat(a.endTime))).format("YYYY/MM/DD HH:mm")})}return a},getCanSelectTime:function(e,t){var n=this,a=e.disableTime.map((function(e){return{startTime:n.$moment("2019/09/03 ".concat(n.$moment(e.startTime).format("HH:mm"))),endTime:n.$moment("2019/09/03 ".concat(n.$moment(e.endTime).format("HH:mm")))}}));a.sort((function(e,t){return new Date(e.startTime)-new Date(t.startTime)}));var i=[];if(a.length>0){var s=this.$moment("".concat(a[0].startTime.format("YYYY/MM/DD")," ").concat(e.startTime)),r=this.$moment("".concat(a[0].startTime.format("YYYY/MM/DD")," ").concat(e.endTime));i.push.apply(i,Object(c["a"])(a.reduce((function(e,t){return e.length<=0&&e.push({}),s.isBetween(t.startTime,t.endTime,null,"[)")?e[0].startTime=t.endTime:t.startTime.isAfter(s)&&t.endTime.isBefore(r)?(e[0].startTime||(e[0].startTime=s),e[e.length-1].endTime||(e[e.length-1].endTime=t.startTime),e.push({startTime:t.endTime})):r.isBetween(t.startTime,t.endTime,null,"(]")&&(e[e.length-1].endTime=t.startTime),e}),[]))),i[i.length-1].startTime||(i[i.length-1].startTime=s),i[i.length-1].endTime||(i[i.length-1].endTime=r)}else i.push.apply(i,Object(c["a"])(t.openTimes.map((function(e){return{startTime:n.$moment("2019/09/03 ".concat(e.openStartTime)),endTime:n.$moment("2019/09/03 ".concat(e.openEndTime))}}))));return i},initStartTimeArr:function(e,t){var n=this,a=t.resvRule,i=a.timeInterval<1?1:parseInt(a.timeInterval);if(!this.canReserve(e,t))return[];var s=[],r=this.formatDisablectData(e,t);this.__initData__=r;r.startTime,r.endTime;return this.__canSelectTime__=this.getCanSelectTime(r,t),this.__canSelectTime__.forEach((function(t){var r=t.startTime,o=t.endTime,l=new Date(r),c=a.latestResvTime,m=void 0===c?0:c,u=a.earliestResvTime,d=void 0===u?0:u,h=n.$moment().add(m,"minutes").format("YYYY/MM/DD HH:mm:ss"),f=n.$moment(h).format("YYYY/MM/DD"),p=n.$moment().add(d,"minutes").format("YYYY/MM/DD HH:mm:ss"),v=n.$moment(e).format("YYYY/MM/DD");while(l-new Date(o)<=0){var g=n.$moment(l).format("HH:mm");v===n.$moment().format("YYYY/MM/DD")||m%1440!==0&&f===v?n.$moment(h).isSameOrBefore("".concat(f," ").concat(g))&&s.push({value:g,max:n.$moment(new Date(o)).format("HH:mm")}):d%1440!==0&&n.$moment(p).format("YYYY/MM/DD")===v?n.$moment(p).isAfter("".concat(n.$moment(p).format("YYYY/MM/DD")," ").concat(g))&&s.push({value:g,max:n.$moment(p).format("HH:mm")}):s.push({value:g,max:n.$moment(new Date(o)).format("HH:mm")}),l=+new Date(l)+60*i*1e3}})),this.filteredMinResvTime(s,t.resvRule.minResvTime,t)},initEndTimeArr:function(e,t,n){if(!e||!e.resvRule)return[];var a=e.resvRule,i=a.timeInterval<1?1:parseInt(a.timeInterval),s=a.minResvTime,r=a.maxResvTime;if(!t)return[];var o=[];this.__canSelectTime__||(this.__initData__||(this.__initData__=this.formatDisablectData(n,e)),this.__canSelectTime__=this.getCanSelectTime(this.__initData__,e));var l={};this.__canSelectTime__.forEach((function(e){new Date("2019/09/03 ".concat(t))>=new Date(e.startTime)&&new Date("2019/09/03 ".concat(t))<new Date(e.endTime)&&(l=e)}));var c=l.startTime,m=l.endTime,u=new Date(c);while(u-new Date(m)<=0)if(u-new Date(+new Date("2019/09/03 ".concat(t))+60*s*1e3)<0)u=+new Date(u)+60*i*1e3;else{if(u-new Date(+new Date("2019/09/03 ".concat(t))+60*r*1e3)>0){u=+new Date(u)+60*i*1e3;break}o.push({value:this.$moment(u).format("HH:mm")}),u=+new Date(u)+60*i*1e3}return o},filteredMinResvTime:function(e,t,n){if(!e||e.length<=0)return[];t||(t=0);var a=n.resvRule,i=(a.latestResvTime,a.earliestResvTime),s=void 0===i?0:i,r=this.$moment().format("YYYY/MM/DD"),o=this.$moment("".concat(r," ").concat(e[e.length-1].value));this.$moment().add(s,"minutes").format("YYYY/MM/DD HH:mm:ss"),o.subtract(t,"minutes");return e},isReserveTimeNotEnough:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=arguments.length>1?arguments[1]:void 0,n=t.openEnd,a=t.resvRule.minResvTime,i=void 0===a?0:a;return!(this.$moment().format("YYYY/MM/DD")!==this.$moment(e).format("YYYY/MM/DD")||!this.$moment().add(i,"minutes").isBetween("".concat(this.$moment().format("YYYY/MM/DD")," ").concat(n),this.$moment("".concat(this.$moment().format("YYYY/MM/DD")," ").concat(n)).add(i,"minutes"),null,"(]"))},mergeReserveInfo:function(e){var t=e.resvInfo;return t&&Array.isArray(t)?(t.sort((function(e,t){return e.startTime-t.startTime})),t.reduce((function(e,t){if((128&t.resvStatus)<=0){var n=t.startTime,a=t.endTime;e.length<=0?e.push({startTime:n,endTime:a}):e[e.length-1].endTime===t.startTime?e[e.length-1].endTime=t.endTime:e.push({startTime:n,endTime:a})}return e}),[])):[]},removeReserveInfo:function(e,t){var n=this,a=this.mergeReserveInfo(t);function i(e){return parseInt(e.split(":").join(""))}return e.filter((function(e){var t=a.findIndex((function(t){var a=t.startTime,s=t.endTime,r=i(n.$moment(a).format("HH:mm")),o=i(n.$moment(s).format("HH:mm")),l=i(e.value);return l>r&&l<o}));return t<0}))},endTimeArrRemoveReserveInfo:function(e,t,n){var a=this;function i(e){return parseInt(e.split(":").join(""))}var s=this.mergeReserveInfo(t),r=s.findIndex((function(e){var t=e.startTime,s=i(a.$moment(t).format("HH:mm")),r=i(n);return s>=r}));return r>=0?e.filter((function(e){var t=i(e.value),n=i(a.$moment(s[r].startTime).format("HH:mm"));return t<=n})):e},judgLimit:function(e,t){return((e&&e.resvRule&&e.resvRule.limit)&t)>0},isOpen:function(e,t){var n=this;if(!e||!e.openTimes||!Array.isArray(e.openTimes))return!1;var a=this.$moment(t).format("YYYY/MM/DD");return this.$moment().isAfter(this.$moment("".concat(a," ").concat(e.openStart)))&&e.openTimes.some((function(e){return n.$moment().isBetween(n.$moment("".concat(a," ").concat(e.openStartTime)),n.$moment("".concat(a," ").concat(e.openEndTime)),null,"[)")})),a===this.$moment().format("YYYY/MM/DD")&&this.$moment().isAfter(this.$moment("".concat(a," ").concat(e.openStart)))&&e.openTimes.some((function(e){return n.$moment().isBetween(n.$moment("".concat(a," ").concat(e.openStartTime)),n.$moment("".concat(a," ").concat(e.openEndTime)),null,"[)")}))},getOpenTime:function(e,t){var n=this;if(e&&e.openTimes&&Array.isArray(e.openTimes)){var a=e.openTimes,i=this.$moment(t).format("YYYY/MM/DD");a.sort((function(e,t){var a=+n.$moment("".concat(i," ").concat(e.openStartTime)).toDate(),s=+n.$moment("".concat(i," ").concat(t.openStartTime)).toDate();return a-s}));var s=a.findIndex((function(e){return n.$moment().isBefore(n.$moment("".concat(i," ").concat(e.openEndTime)))}));return s<0?e.openEnd:a[s].openStartTime}}}},f=h,p=function(){var e=this,t=e._self._c;return t("div",{ref:"seatItem",staticClass:"seat-item",class:{"show-mask":e.isShowMask}},[t("div",{ref:"grid",staticClass:"grid"},[t("img",{ref:"imgItem",attrs:{src:e.imgUrl,ondragstart:"return false",alt:""},on:{load:e.handleImg}}),e._l(e.options,(function(n,a){var i;return t("div",{directives:[{name:"show",rawName:"v-show",value:n.isShow,expression:"item.isShow"}],key:a,ref:"draggable",refInFor:!0,staticClass:"draggable",class:(i={},Object(s["a"])(i,n.className,!e.isEdit),Object(s["a"])(i,"isCheckedSeat",n.isAttrsChecked),i),style:e.widthClass(n),attrs:{title:n.devName},on:{click:function(t){return t.stopPropagation(),e.handleClick(n)}}},[e.isEdit?[e._v(e._s(a+1))]:e._e(),t("em",{directives:[{name:"show",rawName:"v-show",value:e.showName,expression:"showName"}]},[e._v(e._s(n.devName))])],2)})),t("div",{staticClass:"mask"})],2)])},v=[],g=(n("c5f6"),{name:"SeatItem",props:{circleSizeValue:{type:Number,default:16},showName:{type:Boolean,default:!1},options:{type:Array,default:[]},startTime:{type:String,default:""},endTime:{type:String,default:""},isEdit:{type:Boolean,default:!1},canDblClick:{type:Boolean,default:!1},isShowMask:{type:Boolean,default:!1}},data:function(){return{boxWidth:"",boxHeight:0,imgUrl:"",sizeValue:this.circleSizeValue,isEnlarge:!1,times:(new Date).getTime()}},mounted:function(){this.boxWidth=this.$refs.grid.offsetWidth,this.canDblClick&&this.$refs.seatItem.addEventListener("click",this.dblClickEvent)},watch:{options:{handler:function(e,t){}},circleSizeValue:function(e){this.sizeValue=e,this.initStyle()},$route:{handler:function(){var e=this,t=this.$route.params.roomIds;Object(r["d"])({params:{sysType:2,sysValue:t,sysKind:16}}).then((function(t){0===t.code&&t.data&&""!=t.data.content?e.imgUrl="".concat(window.g.ApiUrl,"/").concat(t.data.content):(e.imgUrl="",e.$message({type:"warning",message:e.$t("index_main_seat_failedBgImgMsg")}))}))},immediate:!0}},methods:{dblClickEvent:function(e){(new Date).getTime()-this.times<300&&(this.isEnlarge=!this.isEnlarge,this.handleDblclick()),this.times=(new Date).getTime()},handleDblclick:function(){if(this.isEnlarge){var e=event.offsetX/this.boxWidth,t=event.offsetY/this.boxHeight;this.boxHeight=2*this.boxHeight,this.boxWidth=2*this.boxWidth,this.$refs.imgItem.style.width=this.boxWidth+"px",this.$refs.imgItem.style.height=this.boxHeight+"px",this.$refs.seatItem.scrollTo({left:e-.5>0?this.boxWidth*e+this.boxWidth*Math.abs(e-.5):this.boxWidth*e-this.boxWidth*Math.abs(e-.5),top:t-.5>0?this.boxHeight*t+this.boxHeight*Math.abs(t-.5):this.boxHeight*t-this.boxHeight*Math.abs(t-.5)})}else this.boxHeight=this.boxHeight/2,this.boxWidth=this.boxWidth/2,this.$refs.imgItem.style.width=this.boxWidth+"px",this.$refs.imgItem.style.height=this.boxHeight+"px"},widthClass:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.sizeValue;return{width:parseInt(t)+"px",height:parseInt(t)+"px",fontSize:parseInt(t/1082*this.boxWidth/2)+"px",lineHeight:parseInt(t)+"px",left:null==e.coordinate?"0%":e.coordinate.split(",")[0]+"%",top:null==e.coordinate?"0%":e.coordinate.split(",")[1]+"%"}},initStyle:function(){this.$nextTick((function(){var e=this;this.$refs.draggable.forEach((function(t,n){t.style.width=e.sizeValue+"px",t.style.height=e.sizeValue+"px",t.style.fontSize=e.sizeValue/2+"px",t.style.lineHeight=e.sizeValue+"px",t.style.left=null==e.options[n].coordinate?"0%":e.options[n].coordinate.split(",")[0]+"%",t.style.top=null==e.options[n].coordinate?"0%":e.options[n].coordinate.split(",")[1]+"%"}))}))},handleClick:function(e){this.$emit("handleClickItem",e)},handleImg:function(){this.boxHeight=document.querySelector(".grid img").offsetHeight}}}),_=g,y=(n("ffc2"),n("2877")),b=Object(y["a"])(_,p,v,!1,null,"519ff276",null),T=b.exports,S=function(){var e=this,t=e._self._c;return t("div",{staticClass:"edit-seat"},[t("section",{staticClass:"edit-area"},[t("el-checkbox-group",{model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},e._l(e.checkOptions,(function(n){return t("el-checkbox",{key:n.value,attrs:{label:n.value}},[e._v(e._s(n.label))])})),1),t("div",{staticStyle:{"margin-top":"10px"}},[t("span",[e._v(e._s("".concat(e.$t("common_subSystem_pc")," :")))]),t("el-select",{staticStyle:{width:"100px","margin-left":"10px",height:"40px"},attrs:{size:"small",placeholder:"请选择"},model:{value:e.pcCircleSize,callback:function(t){e.pcCircleSize=t},expression:"pcCircleSize"}},e._l(e.circleSize,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),t("span",{staticStyle:{display:"inline-block","margin-left":"10px"}},[e._v(e._s("".concat(e.$t("common_subSystem_mobile")," :")))]),t("el-select",{staticStyle:{width:"100px","margin-left":"10px",height:"40px"},attrs:{size:"small",placeholder:"请选择"},model:{value:e.mCircleSize,callback:function(t){e.mCircleSize=t},expression:"mCircleSize"}},e._l(e.circleSize,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),t("span",{staticStyle:{display:"inline-block","margin-left":"10px"}},[e._v(e._s("".concat(e.$t("common_subSystem_reserveDesk")," :")))]),t("el-select",{staticStyle:{width:"100px","margin-left":"10px",height:"40px"},attrs:{size:"small",placeholder:"请选择"},model:{value:e.consoleCircleSize,callback:function(t){e.consoleCircleSize=t},expression:"consoleCircleSize"}},e._l(e.circleSize,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("div",{staticClass:"btn_area"},[t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"primary"},on:{click:function(t){return e.leftJustifying(t)}}},[e._v(e._s(e.$t("index_main_seat_editPane_leftJustify")))]),t("el-button",{attrs:{size:"small",type:"success"},on:{click:function(t){return e.rightJustifying(t)}}},[e._v(e._s(e.$t("index_main_seat_editPane_rightJustify")))]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.topJustifying(t)}}},[e._v(e._s(e.$t("index_main_seat_editPane_topJustify")))]),t("el-button",{attrs:{size:"small",type:"success"},on:{click:function(t){return e.bottomJustifying(t)}}},[e._v(e._s(e.$t("index_main_seat_editPane_bottomJustify")))]),t("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(t){return e.handleEditSave(t)}}},[e._v(e._s(e.$t("index_main_seat_editPane_save")))]),t("el-button",{attrs:{size:"small"},on:{click:e.handleEditFalse}},[e._v(e._s(e.$t("index_main_seat_editPane_toUse")))])],1),t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleBatchEdit}},[e._v("批量设置")]),t("el-button",{attrs:{type:"success",size:"small"},on:{click:e.handleSitApart}},[e._v("隔位就坐")]),t("el-button",{attrs:{type:"danger",size:"mini"},on:{click:e.handleDelSelected}},[e._v(e._s(e.$t("index_main_seat_editPane_delete")))]),t("el-select",{staticStyle:{"margin-top":"10px","margin-left":"10px"},attrs:{size:"small",clearable:"",filterable:"",placeholder:e.$t("index_main_seat_editPane_selectSeatTip")},model:{value:e.inMapOptions,callback:function(t){e.inMapOptions=t},expression:"inMapOptions"}},e._l(e.seatOptions,(function(e){return t("el-option",{key:e.devId,class:{optionselected:e.isShow},attrs:{label:e.devName,value:e.devName}})})),1)],1),e._m(0),t("SeatArea",{ref:"seatArea",attrs:{options:e.filteredOptions,total:e.seatOptions.length,isEdit:!0,showName:e.showName,showSeq:e.showSeq,circleSizeValue:e.pcCircleSize,documentKeydownEvent:e.documentKeydownEvent,modalBeforeCreate:e.modalBeforeCreate,modalCreated:e.modalCreated}}),t("el-dialog",{attrs:{visible:e.showOpenEditDia,title:"批量设置","modal-append-to-body":!1,width:"50%","close-on-click-modal":!1},on:{"update:visible":function(t){e.showOpenEditDia=t},opened:e.editDiaOpen}},[t("el-form",{attrs:{"label-width":"80px"}},[t("el-form-item",{attrs:{label:"选择设置"}},[t("el-checkbox-group",{model:{value:e.editSetting,callback:function(t){e.editSetting=t},expression:"editSetting"}},e._l(e.settings,(function(n){return t("el-checkbox",{key:n.value,attrs:{label:n.value}},[e._v(e._s(n.label))])})),1)],1),e._l(e.editSetFormItem,(function(n){return t("el-form-item",{key:n.type,staticStyle:{width:"100%"},attrs:{label:n.label,"label-width":"140px"}},[t("el-radio-group",{model:{value:n.check,callback:function(t){e.$set(n,"check",t)},expression:"item.check"}},e._l(n.value,(function(n){return t("el-radio",{key:n.value,attrs:{label:n.value}},[e._v(e._s(n.label))])})),1)],1)}))],2),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.showOpenEditDia=!1}}},[e._v(e._s(e.$t("com_btn_cancel")))]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleBatchEditState}},[e._v(e._s(e.$t("com_btn_confirm")))])],1)],1),t("el-dialog",{attrs:{visible:e.showSitApartDia,title:"设置隔位就坐","modal-append-to-body":!1,width:"30%","close-on-click-modal":!1},on:{"update:visible":function(t){e.showSitApartDia=t}}},[t("el-form",{attrs:{model:e.sitApartModel,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"是否开启",prop:"status"}},[t("el-radio-group",{model:{value:e.sitApartModel.status,callback:function(t){e.$set(e.sitApartModel,"status",t)},expression:"sitApartModel.status"}},e._l(e.sitApartStatus,(function(n){return t("el-radio",{key:n.value,attrs:{label:n.value}},[e._v(e._s(n.label))])})),1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.showSitApartDia=!1}}},[e._v(e._s(e.$t("com_btn_cancel")))]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handleSitApartCfm(t)}}},[e._v(e._s(e.$t("com_btn_confirm")))])],1)],1)],1)},D=[function(){var e=this,t=e._self._c;return t("section",{staticClass:"edit-status"},[t("span",{staticClass:"status-item open"},[e._v("开放")]),t("span",{staticClass:"status-item noopen_pc"},[e._v("网站不开放")]),t("span",{staticClass:"status-item noopen_desk"},[e._v("预约台不开放")]),t("span",{staticClass:"status-item noopen"},[e._v("全不开放")]),t("span",{staticClass:"status-item open apart"},[e._v("隔位就坐座位")])])}],w=(n("ac4d"),n("8a81"),n("6b54"),function(){var e=this,t=e._self._c;return t("div",{ref:"seatArea",staticClass:"seat-area",class:{"show-mask":e.isShowMask},on:{dblclick:e.onDbClick,mousedown:e.onMouseDown}},[t("div",{staticClass:"grid",style:{transform:"translate(".concat(e.translateObj.x,"px, ").concat(e.translateObj.y,"px) scale(").concat(e.scaleProportion,")"),transformOrigin:"".concat(e.transformOriginObj.x,"% ").concat(e.transformOriginObj.y,"%")}},[t("img",{ref:"bgImg",attrs:{src:e.imgUrl,alt:"",ondragstart:"return false"},on:{load:e.handleImg}}),e.canCreateSeats?e._l(e.options,(function(n){var a;return t("div",{directives:[{name:"show",rawName:"v-show",value:n.isShow,expression:"item.isShow"}],key:n.devId,ref:"draggable",refInFor:!0,staticClass:"draggable",class:(a={},Object(s["a"])(a,n.className,!e.isEdit),Object(s["a"])(a,n.edit_className,e.isEdit&&n.edit_className),Object(s["a"])(a,"isCheckedSeat",n.isAttrsChecked),Object(s["a"])(a,"isSelected",n.__isSelected__),a),style:e.widthClass(n),attrs:{title:e.getTitle(n),draggable:!1},on:{click:function(t){return t.stopPropagation(),e.handleClick(n,t)}}},[e.isEdit&&e.showSeq?[t("span",{staticClass:"txt",style:{transform:"scale(".concat(e.circleSizeValue/24,")")}},[e._v(e._s("".concat(n.devName.slice(-3))))])]:e._e(),t("em",{directives:[{name:"show",rawName:"v-show",value:e.showName,expression:"showName"}],style:{whiteSpace:"nowrap",transform:"translate(-50%, -24%) scale(".concat(e.circleSizeValue/20,")")}},[e._v(e._s(n.devName))])],2)})):e._e(),t("div",{ref:"mask",staticClass:"mask"}),t("div",{staticClass:"selectmodal",style:{width:"".concat(e.selectModal.width,"%"),height:"".concat(e.selectModal.height,"%"),top:"".concat(e.selectModal.top,"%"),left:"".concat(e.selectModal.left,"%")}})],2)])}),O=[],I={name:"SeatArea",props:{options:{type:Array,default:function(){return[]}},total:{type:Number,default:0},isEdit:{type:Boolean,default:!1},circleSizeValue:{type:Number,default:16},showName:{type:Boolean,default:!1},showSeq:{type:Boolean,default:!1},isShowMask:{type:Boolean,default:!1},documentKeydownEvent:{type:Function,default:function(){}},canDbClick:{type:Boolean,default:!1},modalBeforeCreate:{type:Function,default:function(){}},modalCreated:{type:Function,default:function(){}},dateValue:{type:Date,default:function(){return new Date}}},data:function(){return{imgUrl:"",boxHeight:"",sizeValue:this.circleSizeValue,curDbClickCount:0,maxDbClickCount:3,scaleProportion:1,maxScale:2,pageObj:{pageYOffset:0,pageXOffset:0},transformOriginObj:{x:0,y:0},isMouseDown:!1,mouseDownCoor:{x:0,y:0},mdTranslateObj:{x:0,y:0},translateObj:{x:0,y:0},isSeatDown:!1,translateSeatObj:{x:0,y:0},curSeatObj:{target:null,x:0,y:0},isModalCreating:!1,selectedSeats:[],selectSeatsDOM:[],selectModal:{width:0,height:0,left:0,top:0,leftCpy:0,topCpy:0},seatAreaState:1,canCreateSeats:!1}},watch:{$route:{handler:function(){var e=this.$route.params.roomIds;this.getImage(e)},immediate:!0},circleSizeValue:function(e){this.sizeValue=e,this.initStyle()},isEdit:{handler:function(e){e&&(this.curDbClickCount=0,this.updateScaleProportion(),this.checkBoundary())}},options:{handler:function(e){var t=this;e.forEach((function(e){t.$set(e,"__isSelected__",!1)}))}}},computed:{totalOptions:function(){return this.total.toString().length},leftBoundary:function(){return Math.ceil(this.transformOriginObj.x/100*this.seatAreaObj.clientWidth*(this.scaleProportion-1))},topBoundary:function(){return Math.ceil(this.transformOriginObj.y/100*this.seatAreaObj.clientHeight*(this.scaleProportion-1))},seatAreaObj:function(){var e={offsetLeft:0,offsetTop:0,clientHeight:0,clientWidth:0},t=this.$refs.seatArea;return this.seatAreaState&&t&&(e.offsetLeft=t.offsetLeft,e.offsetTop=t.offsetTop,e.clientHeight=t.clientHeight,e.clientWidth=t.clientWidth),e}},mounted:function(){var e=this;this.pageObj.pageXOffset=parseFloat(window.pageXOffset.toFixed(6)),this.pageObj.pageYOffset=parseFloat(window.pageYOffset.toFixed(6)),window.onscroll=this.debounce((function(t){e.pageObj.pageXOffset=parseFloat(window.pageXOffset.toFixed(6)),e.pageObj.pageYOffset=parseFloat(window.pageYOffset.toFixed(6))})),window.onresize=this.debounce((function(t){e.updateSeatAreaObj()}))},beforeDestroy:function(){window.onscroll=null,window.onresize=null},methods:{debounce:function(e){var t=null;return function(n){t&&clearTimeout(t),t=setTimeout((function(){e(n)}),200)}},updateSeatAreaObj:function(){var e=this;this.$nextTick((function(){var t=e.$refs.seatArea;e.seatAreaState=t.offsetWidth}))},updateScaleProportion:function(){this.curDbClickCount>0?this.scaleProportion=1+.25*Math.pow(2,this.curDbClickCount-1):this.scaleProportion=1},onMouseDown:function(e){var t=e.target||e.srcElement;if(!this.isEdit&&this.scaleProportion>1&&(t===this.$refs.bgImg||t===this.$refs.mask))e.preventDefault(),e.stopPropagation(),this.onMapDown(e);else if(this.isEdit&&t===this.$refs.bgImg)e.preventDefault(),e.stopPropagation(),this.onSelectModalDown(e);else{if(!this.isEdit)return;this.onSeatDown(e)}},onMouseMove:function(e){e.preventDefault(),e.stopPropagation(),this.isEdit?this.onSelectModalMove(e):this.onMapMove(e)},onMouseUp:function(e){this.isEdit?this.onSelectModalUp(e):this.onMapUp(e)},onMapDown:function(e){this.isMouseDown=!0,this.mouseDownCoor.x=e.clientX,this.mouseDownCoor.y=e.clientY,this.mdTranslateObj.x=this.translateObj.x,this.mdTranslateObj.y=this.translateObj.y,document.onmousemove=this.onMouseMove,document.onmouseup=this.onMouseUp},onMapMove:function(e){if(this.isMouseDown){var t=e.clientX-this.mouseDownCoor.x,n=e.clientY-this.mouseDownCoor.y;this.translateObj.x=this.mdTranslateObj.x+t,this.translateObj.y=this.mdTranslateObj.y+n}},onMapUp:function(e){this.isMouseDown&&(this.checkBoundary(),document.onmousemove=null,document.onmouseup=null)},checkBoundary:function(){var e=this.seatAreaObj.clientWidth*(this.scaleProportion-1)-this.leftBoundary,t=this.seatAreaObj.clientHeight*(this.scaleProportion-1)-this.topBoundary;this.translateObj.x>this.leftBoundary?this.translateObj.x=this.leftBoundary:this.translateObj.x<-1*e&&(this.translateObj.x=-1*e),this.translateObj.y>this.topBoundary?this.translateObj.y=this.topBoundary:this.translateObj.y<-1*t&&(this.translateObj.y=-1*t)},isSeat:function(e){return this.$refs.draggable.findIndex((function(t){return t===e}))>=0},onSeatDown:function(e){this.isSeatDown=!0;var t=e.target||e.srcElement;this.isSeat(t)||(t=t.parentNode),this.curSeatObj.x=parseFloat(t.style.left)/100*this.seatAreaObj.clientWidth,this.curSeatObj.y=parseFloat(t.style.top)/100*this.seatAreaObj.clientHeight,this.curSeatObj.target=t,this.translateSeatObj.x=e.clientX,this.translateSeatObj.y=e.clientY,document.onmousemove=this.onSeatMove,document.onmouseup=this.onSeatUp},onSeatMove:function(e){if(this.isSeatDown){var t=e.clientX-this.translateSeatObj.x,n=e.clientY-this.translateSeatObj.y,a=this.curSeatObj.x+t,i=this.curSeatObj.y+n,s=this.seatAreaObj.clientWidth-this.sizeValue,r=this.seatAreaObj.clientHeight-this.sizeValue;a<0?a=0:a>s&&(a=s),i<0?i=0:i>r&&(i=r),this.curSeatObj.target.style.left=this.pxToPercent(a,this.seatAreaObj.clientWidth)+"%",this.curSeatObj.target.style.top=this.pxToPercent(i,this.seatAreaObj.clientHeight)+"%"}},onSeatUp:function(e){this.isSeatDown&&(this.isSeatDown=!1,document.onmousemove=null,document.onmouseup=null)},initTransformOriginObj:function(e){this.transformOriginObj.x=((e.clientX-this.seatAreaObj.offsetLeft+this.pageObj.pageXOffset)/this.seatAreaObj.clientWidth*100).toFixed(2),this.transformOriginObj.y=((e.clientY-this.seatAreaObj.offsetTop+this.pageObj.pageYOffset)/this.seatAreaObj.clientHeight*100).toFixed(2)},onSelectModalDown:function(e){this.isModalCreating=!0;var t=e.clientX+this.pageObj.pageXOffset-this.seatAreaObj.offsetLeft,n=e.clientY+this.pageObj.pageYOffset-this.seatAreaObj.offsetTop;this.selectModal.left=this.selectModal.leftCpy=this.pxToPercent(t,this.seatAreaObj.clientWidth),this.selectModal.top=this.selectModal.topCpy=this.pxToPercent(n,this.seatAreaObj.clientHeight),document.onmousemove=this.onMouseMove,document.onmouseup=this.onMouseUp,this.modalBeforeCreate(e)},onSelectModalMove:function(e){if(this.isModalCreating){var t=parseFloat((e.clientX+this.pageObj.pageXOffset-this.seatAreaObj.offsetLeft).toFixed(6)),n=parseFloat((e.clientY+this.pageObj.pageYOffset-this.seatAreaObj.offsetTop).toFixed(6)),a=this.pxToPercent(t,this.seatAreaObj.clientWidth),i=this.pxToPercent(n,this.seatAreaObj.clientHeight);a>100?a=100:a<0&&(a=0),i>100?i=100:i<0&&(i=0),this.selectModal.width=Math.abs(a-this.selectModal.leftCpy),this.selectModal.height=Math.abs(i-this.selectModal.topCpy),this.selectModal.left=a>this.selectModal.leftCpy?this.selectModal.leftCpy:a,this.selectModal.top=i>this.selectModal.topCpy?this.selectModal.topCpy:i}},onSelectModalUp:function(e){var t=this;this.isModalCreating=!1,this.selectedSeats.forEach((function(e){e.__isSelected__=!1}));var n=this.$refs.draggable;this.selectSeatsDOM=Array.isArray(n)?n.filter((function(e){var n="none"!==e.style.display;if(n){var a=e.style.left.indexOf("%")>0?parseFloat(e.style.left):(parseFloat(e.style.left)/t.seatAreaObj.clientWidth).toFixed(6),i=e.style.top.indexOf("%")>0?parseFloat(e.style.top):(parseFloat(e.style.top)/t.seatAreaObj.clientHeight).toFixed(6),s=(a-t.selectModal.left).toFixed(6),r=(i-t.selectModal.top).toFixed(6);return s>=0&&s<=t.selectModal.width&&r>=0&&r<=t.selectModal.height}})):[];var a=this.selectSeatsDOM.map((function(e){return e.title}));this.selectedSeats=[],this.options.forEach((function(e){a.includes(e.devName)&&(e.__isSelected__=!0,t.selectedSeats.push(e))})),this.resetSelectModal(),document.onmousemove=null,document.onmouseup=null,this.setDocumentKeyDownEvent(),this.modalCreated(e)},setDocumentKeyDownEvent:function(){document.eventList||(document.eventList={}),this.selectedSeats.length>0?document.eventList["keydown"]||(document.eventList["keydown"]=!0,document.addEventListener("keydown",this.documentKeydownEvent)):document.eventList["keydown"]&&(document.eventList["keydown"]=!1,document.removeEventListener("keydown",this.documentKeydownEvent))},removeDocumentKeyDownEvent:function(){document.eventList&&(document.eventList["keydown"]=!1,document.removeEventListener("keydown",this.documentKeydownEvent))},resetSelectModal:function(){this.selectModal.width=0,this.selectModal.height=0,this.selectModal.left=0,this.selectModal.top=0,this.selectModal.leftCpy=0,this.selectModal.topCpy=0},onDbClick:function(e){var t=this;!this.isEdit&&this.canDbClick&&(this.pageObj.pageXOffset=parseFloat(window.pageXOffset.toFixed(6)),this.pageObj.pageYOffset=parseFloat(window.pageYOffset.toFixed(6)),this.curDbClickCount<this.maxDbClickCount?this.curDbClickCount++:this.curDbClickCount=0,this.updateScaleProportion(),this.initTransformOriginObj(e),this.$nextTick((function(){t.checkBoundary()})))},handleImg:function(){this.canCreateSeats=!0,this.boxHeight=this.$refs.bgImg&&this.$refs.bgImg.offsetHeight,this.updateSeatAreaObj(),this.curDbClickCount=0,this.updateScaleProportion(),this.checkBoundary()},widthClass:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.sizeValue;return{width:parseInt(t)+"px",height:parseInt(t)+"px",fontSize:parseInt(t/1082*this.boxWidth/2)+"px",lineHeight:parseInt(t)+"px",left:null==e.coordinate?"0%":e.coordinate.split(",")[0]+"%",top:null==e.coordinate?"0%":e.coordinate.split(",")[1]+"%"}},initStyle:function(){this.$nextTick((function(){var e=this,t=this.$refs.draggable;t&&Array.isArray(t)&&t.forEach((function(t,n){t.style.width=e.sizeValue+"px",t.style.height=e.sizeValue+"px",t.style.fontSize=e.sizeValue/2+"px",t.style.lineHeight=e.sizeValue+"px",t.style.left=null==e.options[n].coordinate?"0%":e.options[n].coordinate.split(",")[0]+"%",t.style.top=null==e.options[n].coordinate?"0%":e.options[n].coordinate.split(",")[1]+"%"}))}))},ctrlKeySelectSeat:function(e,t){if(e.__isSelected__){var n=this.selectedSeats.findIndex((function(t){return t.devName===e.devName}));n>=0&&this.selectedSeats.splice(n,1);var a=this.selectSeatsDOM.findIndex((function(t){return t.title===e.devName}));a>=0&&this.selectSeatsDOM.splice(a,1)}else{this.selectedSeats.push(e);var i=this.$refs.draggable.find((function(t){return t.title===e.devName}));i&&this.selectSeatsDOM.push(i)}e.__isSelected__=!e.__isSelected__,this.setDocumentKeyDownEvent()},handleClick:function(e,t){this.isEdit&&t.ctrlKey?this.ctrlKeySelectSeat(e,t):this.$emit("handleClickItem",e)},getAllSelectedSeats:function(){return Array.isArray(this.selectedSeats)?this.selectedSeats:[]},getAllSelectedDom:function(){return Array.isArray(this.selectSeatsDOM)?this.selectSeatsDOM:[]},getImage:function(e){var t=this;this.imgUrl="",Object(r["d"])({params:{sysType:2,sysValue:e,sysKind:16}}).then((function(e){0===e.code&&e.data&&""!=e.data.content?t.imgUrl="".concat(window.g.ApiUrl,"/").concat(e.data.content):t.$message({type:"warning",message:t.$t("index_main_seat_failedBgImgMsg")})}))},pxToPercent:function(e,t){return isNaN(parseInt(e))&&(e=0),isNaN(parseInt(t))&&(t=0),0===t?0:100*(e/t).toFixed(6)},getTitle:function(e){if(this.isEdit||!e.resvInfo||!Array.isArray(e.resvInfo)||e.resvInfo.length<=0)return e.devName;var t=this.getFreeArray(this.dateValue,e),n=t.map((function(e){var t=e.startTime,n=e.endTime;return"".concat(t," - ").concat(n)}));return n.length>0?n.reduce((function(e,t){return e+"\n"+t}),"".concat(e.devName,"\n空闲时间：")):"".concat(e.devName,"\n空闲时间：无")},getFreeArray:function(e,t){var n=this,a=this.$moment(e).format("YYYY/MM/DD"),i=t.resvInfo,s=t.openStart,r=t.openEnd,o=Object(c["a"])(i).sort((function(e,t){return e.startTime-t.startTime})),l=o.reduce((function(e,t){if((128&t.resvStatus)<=0){var n=t.startTime,a=t.endTime;e.length<=0?e.push({startTime:n,endTime:a}):e[e.length-1].endTime===t.startTime?e[e.length-1].endTime=t.endTime:e.push({startTime:n,endTime:a})}return e}),[]),m=s;this.$moment().isSame(e,"day")&&(m=this.$moment().add(1,"minute").format("HH:mm"));var u=l.filter((function(e){return n.$moment(e.endTime).isSameOrAfter("".concat(a," ").concat(m))&&(128&e.resvStatus)<=0})),d=u.reduce((function(e,t){var i=t.startTime,s=t.endTime,o={startTime:"",endTime:""},l=n.$moment("".concat(a," ").concat(m)).isBetween(i,s,null,"[]");return l?n.$moment(s).format("HH:mm")!=r&&(o.startTime=n.$moment(s).format("HH:mm"),e.push(o)):(e.length>0&&!e[e.length-1].endTime?e[e.length-1].endTime=n.$moment(i).format("HH:mm"):(o.startTime=m,o.endTime=n.$moment(i).format("HH:mm"),e.push(o)),n.$moment(s).format("HH:mm")!=r&&e.push({startTime:n.$moment(s).format("HH:mm"),endTime:""})),e}),[]);return d.length>0&&!d[d.length-1].endTime&&(d[d.length-1].endTime=r),d}}},Y=I,$=(n("b176"),Object(y["a"])(Y,w,O,!1,null,"78ef6e2c",null)),x=$.exports;function A(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=k(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return r=e.done,e},e:function(e){o=!0,s=e},f:function(){try{r||null==n.return||n.return()}finally{if(o)throw s}}}}function k(e,t){if(e){if("string"===typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M(e,t):void 0}}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var C={SHOWNAME:1,SHOWSEQ:4},j={PC_KEY:1,CONSOLE_KEY:2,MOBILE_KEY:4},R={PC_NOOPEN:1,PAGE_SHOW:2,CONSOLE_NOOPEN:4,SIT_APART:64},E={name:"EditSeat",components:{SeatArea:x},props:{seatOptions:{type:Array,default:function(){return[]}}},data:function(){return this.checkOptions=[{value:C.SHOWNAME,label:this.$t("index_main_seat_editPane_checbox1")},{value:C.SHOWSEQ,label:"显示序号"}],this.circleSize=[{value:4,label:4},{value:6,label:6},{value:8,label:8},{value:10,label:10},{value:12,label:12},{value:14,label:14},{value:16,label:16},{value:20,label:20},{value:24,label:24},{value:28,label:28}],this.settings=[{label:"设备在网页端状态",value:2},{label:"设备在预约台端状态",value:4},{label:"隔位就坐状态",value:R.SIT_APART}],this.sitApartStatus=[{label:"开启",value:1},{label:"关闭",value:0}],{checkList:[],pcCircleSize:12,consoleCircleSize:12,mCircleSize:12,checkedProps:[],inMapOptions:[],clickSelectedItem:{oldClass:"",prevItem:null},creatingIdxArr:[],positionDownAndUp:{down:{x:0,y:0},up:{x:0,y:0}},showOpenEditDia:!1,editSetting:[],editSetFormItem:[],filteredOptions:[],showSitApartDia:!1,sitApartModel:{status:1}}},computed:{showName:function(){return Array.isArray(this.checkList)&&this.checkList.includes(C.SHOWNAME)},showSeq:function(){return Array.isArray(this.checkList)&&this.checkList.includes(C.SHOWSEQ)},seatAreaObj:function(){return this.$refs.seatArea}},watch:{seatOptions:{handler:function(e,t){var n=this;if(e&&Array.isArray(e)&&!(e.length<=0)){var a=e[0],i=a.pointSize,s=a.pointProperty;i&&(this.pcCircleSize=i[j.PC_KEY]||12,this.consoleCircleSize=i[j.CONSOLE_KEY]||12,this.mCircleSize=i[j.MOBILE_KEY]||12),e.forEach((function(e){var t=e.devProp;t&R.PAGE_SHOW?(n.$set(e,"isShow",!0),n.$set(e,"edit_className",""),n.setEditClassName(e)):n.$set(e,"isShow",!1)})),this.filteredOptions=e.filter((function(e){return e.coordinate})),s&&this.checkList.push(s)}},immediate:!0},inMapOptions:function(e){var t=document.querySelector(".grid");if(this.clickSelectedItem.prevItem&&(this.clickSelectedItem.prevItem.style.backgroundColor=this.clickSelectedItem.oldClass),e){var n=this.seatOptions,a=n.filter((function(e){return e.isShow})),i=a.filter((function(t){return t.devName===e})),s=document.querySelectorAll(".grid .draggable");if(this.creatingIdxArr=[],i.length>0){var r=Array.prototype.slice.call(s),o=r.filter((function(e){return e.title===i[0].devName}));this.clickSelectedItem.oldClass=o[0].style.backgroundColor,this.clickSelectedItem.prevItem=o[0],o[0].style.backgroundColor="red"}else{for(var l=n.findIndex((function(t){return t.devName===e})),c=l,m=n.length;c<m;c++){if(n[c].isShow)break;this.creatingIdxArr.push(c)}u["a"].addHandler(t,"click",this.clickIsInMapHandler)}}else u["a"].removeHandler(t,"click",this.clickIsInMapHandler)},editSetting:function(e,t){var n=this;if(e.length>t.length){var a=e.filter((function(e){return!t.includes(e)}));a.length>0&&a.forEach((function(e){2===e&&n.editSetFormItem.push({label:"设备在网页端状态",value:[{label:"开放",value:1},{label:"不开放",value:0}],check:1,type:2}),4===e&&n.editSetFormItem.push({label:"设备在预约台端状态",value:[{label:"开放",value:1},{label:"不开放",value:0}],check:1,type:4}),e===R.SIT_APART&&n.editSetFormItem.push({label:"隔位就坐状态",value:[{label:"是",value:1},{label:"否",value:0}],check:1,type:R.SIT_APART})}))}else{var i=t.filter((function(t){return!e.includes(t)}));i.length>0&&i.forEach((function(e){var t=n.editSetFormItem.findIndex((function(t){return t.type===e}));-1!==t&&n.editSetFormItem.splice(t,1)}))}}},methods:{setEditClassName:function(e){var t=e.devProp,n=t&R.PAGE_SHOW,a=t&R.PC_NOOPEN,i=t&R.CONSOLE_NOOPEN,s=t&R.SIT_APART;e["edit_className"]=a&&!i?"noopen_pc":!a&&i?"noopen_desk":a&&i?"noopen":"open",s&&(e["edit_className"]+=n?" apart":" apartNoOpen")},handleBatchEdit:function(){var e=this.seatAreaObj.getAllSelectedSeats();e.length<=0?this.$message({type:"info",message:"请选择要设置的座位"}):this.showOpenEditDia=!0},editDiaOpen:function(){this.editSetting=[]},handleBatchEditState:function(){var e=this;this.editSetFormItem.length<=0?this.$message({type:"info",message:"请选择要设置的状态"}):this.editSetFormItem.forEach((function(t){e.setOpenSeats(t.type,t.check)}))},setOpenSeats:function(e,t){var n=this,a=this.seatAreaObj.getAllSelectedSeats();a.forEach((function(n){2===e&&(0===t?(n.devProp&R.PC_NOOPEN)<=0&&(n.devProp+=R.PC_NOOPEN):1===t&&(n.devProp&R.PC_NOOPEN)>0&&(n.devProp-=R.PC_NOOPEN)),4===e&&(0===t?(n.devProp&R.CONSOLE_NOOPEN)<=0&&(n.devProp+=R.CONSOLE_NOOPEN):1===t&&(n.devProp&R.CONSOLE_NOOPEN)>0&&(n.devProp-=R.CONSOLE_NOOPEN)),e===R.SIT_APART&&(1===t?(n.devProp&R.SIT_APART)<=0&&(n.devProp+=R.SIT_APART):0===t&&(n.devProp&R.SIT_APART)>0&&(n.devProp-=R.SIT_APART))})),a.forEach((function(e){var t=e.devProp;if(t&R.PAGE_SHOW){e["edit_className"];n.setEditClassName(e)}})),this.showOpenEditDia=!1,this.$notify.success({title:"提示",message:"设置成功, 记得点击保存按钮",showClose:!0})},handleSitApart:function(){this.showSitApartDia=!0},handleSitApartCfm:function(e){var t=this,n=1===this.sitApartModel.status;this.seatOptions.forEach((function(e){var a=(e.devProp&R.SIT_APART)>0,i=(e.devProp&R.PAGE_SHOW)>0;n&&a?(i&&(e.devProp-=R.PAGE_SHOW),e.isShow=!1):(!i&&(e.devProp+=R.PAGE_SHOW),e.isShow=!0,t.setEditClassName(e))})),this.showSitApartDia=!1,this.$notify.success({title:"提示",message:n?"开启成功, 记得点击保存按钮":"关闭成功, 记得点击保存按钮",showClose:!0})},handleEditFalse:function(e){this.seatAreaObj.removeDocumentKeyDownEvent(),this.$emit("cancel",e)},handleEditSave:function(e){var t=this.pcCircleSize,n=this.mCircleSize,a=this.consoleCircleSize,i=this.checkList;this.$emit("save",this.seatOptions,{pcCircleSize:t,mCircleSize:n,consoleCircleSize:a,checkList:i},e)},handleDelSelected:function(){var e=this.seatAreaObj.getAllSelectedSeats();e.length<=0?this.$message({message:this.$t("index_main_seat_editPane_dragDelMsg"),type:"info"}):e.forEach((function(e,t){2&e.devProp&&(e.isShow=!1,e.devProp=e.devProp-2,e.__isSelected__=!1)}))},modalBeforeCreate:function(e){this.positionDownAndUp.down.x=e.clientX,this.positionDownAndUp.down.y=e.clientY},modalCreated:function(e){this.positionDownAndUp.up.x=e.clientX,this.positionDownAndUp.up.y=e.clientY},clickIsInMapHandler:function(e){var t=this.positionDownAndUp,n=t.down,a=n.x,i=n.y,s=t.up,r=s.x,o=s.y;if(a===r&&i===o){var l=this.creatingIdxArr.shift(),c=this.seatOptions[l];if(c&&(c.coordinate="".concat((e.offsetX/e.target.clientWidth*100).toFixed(2),",").concat((e.offsetY/e.target.clientHeight*100).toFixed(2)),c.isShow=!0,c.devProp=c.devProp+2),this.creatingIdxArr.length<=0){var m=document.querySelector(".grid");u["a"].removeHandler(m,"click",this.clickIsInMapHandler)}this.$set(this.seatOptions,l,Object.assign(c))}},documentKeydownEvent:function(e){e.preventDefault(),e.stopPropagation();var t=2;switch(e.keyCode){case 37:this.justifying("left",t);break;case 38:this.justifying("top",t);break;case 39:this.justifying("right",t);break;case 40:this.justifying("bottom",t);break}},justifying:function(e,t){var n=document.querySelector(".grid img"),a=n.clientHeight,i=n.clientWidth,s=this.seatAreaObj.getAllSelectedDom();if("top"===e||"bottom"===e){var r,o=A(s);try{for(o.s();!(r=o.n()).done;){var l=r.value,c=l.style.top,m=c.indexOf("%")>0?a*parseFloat(c)/100:parseFloat(c),u=0;if("top"===e){var d=m-t;u=d>0&&(d/a*100).toFixed(6)}else{var h=l.clientHeight,f=Math.ceil(a-h),p=m+t;p>f&&(p=f),u=(p/a*100).toFixed(6)}l.style.top=u+"%"}}catch(I){o.e(I)}finally{o.f()}}else if("right"===e||"left"===e){var v,g=A(s);try{for(g.s();!(v=g.n()).done;){var _=v.value,y=_.style.left,b=y.indexOf("%")>0?i*parseFloat(y)/100:parseFloat(y),T=0;if("left"===e){var S=b-t;T=S>0&&(S/i*100).toFixed(6)}else{var D=_.clientWidth,w=Math.ceil(i-D),O=b+t;O>w&&(O=w),T=(O/i*100).toFixed(6)}_.style.left=T+"%"}}catch(I){g.e(I)}finally{g.f()}}},topJustifying:function(e){e.stopPropagation();var t,n=[],a=document.querySelector(".grid"),i=this.seatAreaObj.getAllSelectedDom(),s=A(i);try{for(s.s();!(t=s.n()).done;){var r=t.value,o=r.style.top.indexOf("%")>0?(a.clientHeight*parseFloat(r.style.top)/100).toFixed(6):r.style.top;n.push(parseInt(o))}}catch(m){s.e(m)}finally{s.f()}var l=Math.min.apply(Math,n),c=(l/a.clientHeight*100).toFixed(6)+"%";i.forEach((function(e){e.style.top=c}))},rightJustifying:function(e){e.stopPropagation();var t,n=document.querySelector(".grid"),a=this.seatAreaObj.getAllSelectedDom(),i=[],s=A(a);try{for(s.s();!(t=s.n()).done;){var r=t.value,o=r.style.left.indexOf("%")>0?(n.clientWidth*parseFloat(r.style.left)/100).toFixed(6):r.style.left;i.push(n.clientWidth-parseInt(o))}}catch(m){s.e(m)}finally{s.f()}var l=Math.min.apply(Math,i),c=((n.clientWidth-l)/n.clientWidth*100).toFixed(6)+"%";a.forEach((function(e){e.style.left=c}))},bottomJustifying:function(e){e.stopPropagation();var t,n=document.querySelector(".grid"),a=this.seatAreaObj.getAllSelectedDom(),i=[],s=A(a);try{for(s.s();!(t=s.n()).done;){var r=t.value,o=r.style.top.indexOf("%")>0?(r.parentNode.clientHeight*parseFloat(r.style.top)/100).toFixed(6):r.style.top;i.push(n.clientHeight-parseInt(o))}}catch(m){s.e(m)}finally{s.f()}var l=Math.min.apply(Math,i),c=((n.clientHeight-l)/n.clientHeight*100).toFixed(6)+"%";a.forEach((function(e){e.style.top=c}))},leftJustifying:function(e){e.stopPropagation();var t,n=this.seatAreaObj.getAllSelectedDom(),a=[],i=A(n);try{for(i.s();!(t=i.n()).done;){var s=t.value,r=s.style.left.indexOf("%")>0?(s.parentNode.clientWidth*parseFloat(s.style.left)/100).toFixed(6):s.style.left;a.push(parseInt(r))}}catch(m){i.e(m)}finally{i.f()}var o=document.querySelector(".grid"),l=Math.min.apply(Math,a),c=(l/o.clientWidth*100).toFixed(6)+"%";n.forEach((function(e){e.style.left=c}))}}},P=E,H=(n("f490"),Object(y["a"])(P,S,D,!1,null,"7f442c9c",null)),N=H.exports,F=function(){var e=this,t=e._self._c;return t("div",{staticClass:"seat-form"},[e.dialogVisible?t("el-dialog",{staticClass:"dia-style",attrs:{top:"5vh",width:"750px",title:e.$t("index_main_seatForm_title"),visible:e.dialogVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.SeatInfo&&e.isShowReserveInfo&&!e.isZju?t("research-info",{attrs:{roomInfo:e.SeatInfo,showPerLimit:!1}}):e._e(),t("div",{staticClass:"showTime"},[t("div",{staticClass:"showTime-title"},[e._v("\r\n          "+e._s(e.$t("index_main_seatForm_currentTime"))+"\r\n        ")]),t("SeatTimeBar",{attrs:{reserveInfo:e.SeatInfo,dateValue:e.dateValue,newInfo:e.newInfo}})],1),t("div",{staticClass:"data-box"},[t("div",{staticClass:"research-title"},[t("div",{staticClass:"title-left"},[t("span",{staticClass:"title-label"},[e._v(e._s("".concat(e.$t("index_main_seatForm_targetName"),":")))]),t("span",[e._v(e._s(e.SeatInfo.labName+e.SeatInfo.devName))])]),t("div",{staticClass:"title-right"},[t("span",{staticClass:"title-label"},[e._v(e._s("".concat(e.$t("index_main_seatForm_applicant"),":")))]),e._v(e._s(e.userInfo.trueName)+" ("),t("span",[e._v(e._s(e.userInfo.logonName))]),e._v(")\r\n          ")]),t("div",[t("span",{staticClass:"title-label"},[e._v(e._s("".concat(e.$t("index_main_seatForm_dateRange"),":")))]),e._v("\r\n            ("),t("span",[e._v(e._s(e.$moment(e.dateValue).format("YYYY-MM-DD")))]),e._v(")\r\n          ")]),e.isShowTemporarilyleave?t("div",[t("span",{staticClass:"title-label"},[e._v(e._s("".concat(e.$t("index_main_seatForm_Temporarilyleave"),":")))]),t("span",[e._v(e._s(e.Temporarilyleave)+e._s("".concat(e.$t("const_PcServe_text15"))))])]):e._e()]),t("div",{staticStyle:{width:"80%"}},[t("el-form",{ref:"form",attrs:{"label-width":"120px",model:e.formData,rules:e.rules}},[(8&e.sysConfig.resvTheme)>0&&0==(1024&e.SeatInfo.resvRule.limit)?t("el-form-item",{attrs:{label:e.$t("index_main_profile_ReserveDia_theme"),prop:"title"}},[e.isThemeInput?t("el-input",{attrs:{size:"small",placeholder:"请输入主题"},model:{value:e.formData.title,callback:function(t){e.$set(e.formData,"title",t)},expression:"formData.title"}}):t("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",placeholder:"请选择主题"},model:{value:e.formData.title,callback:function(t){e.$set(e.formData,"title",t)},expression:"formData.title"}},e._l(e.titleArr,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),t("el-form-item",{attrs:{label:e.$t("index_main_seatForm_timeRange")}},[2&e.SeatInfo.openTimes[0].openLimit?t("div",[t("el-select",{attrs:{size:"small",placeholder:e.$t("common_select_placeholder")},on:{change:e.handleNotFreeTimeChange},model:{value:e.noFreeSelectTime,callback:function(t){e.noFreeSelectTime=t},expression:"noFreeSelectTime"}},e._l(e.notFreeTimeArr,(function(e,n){return t("el-option",{key:n,attrs:{label:e.value,value:e.value}})})),1)],1):t("div",[e.judgLimit(e.SeatInfo,64)?t("span",[e.isOpen(e.SeatInfo,e.dateValue)?t("span",[e._v("\r\n                    "+e._s(e.$t("index_main_seatForm_currentTime"))+"\r\n                  ")]):t("span",[e._v("\r\n                    "+e._s(e.openStart)+"\r\n                  ")])]):t("el-select",{attrs:{size:"small",placeholder:e.$t("common_select_placeholder")},model:{value:e.formData.startTime,callback:function(t){e.$set(e.formData,"startTime",t)},expression:"formData.startTime"}},e._l(e.startTimeArr,(function(e,n){return t("el-option",{key:n,attrs:{label:e.value,value:e.value}})})),1),e._v("\r\n                ~\r\n                "),e.judgLimit(e.SeatInfo,128)&&e.judgLimit(e.SeatInfo,64)?t("span",[e._v("\r\n                  "+e._s(e.closeTime)+"\r\n                ")]):t("el-select",{attrs:{size:"small",placeholder:e.$t("common_select_placeholder")},model:{value:e.formData.endTime,callback:function(t){e.$set(e.formData,"endTime",t)},expression:"formData.endTime"}},e._l(e.endTimeArr,(function(e,n){return t("el-option",{key:n,attrs:{label:e.value,value:e.value}})})),1)],1)]),"1"===e.sysConfig.resvCode?t("el-form-item",{attrs:{label:e.$t("common_placeholder_captcha"),prop:"captcha"}},[t("div",{staticClass:"code-wrapper"},[t("el-input",{staticStyle:{width:"30%"},attrs:{size:"small"},model:{value:e.formData.captcha,callback:function(t){e.$set(e.formData,"captcha",t)},expression:"formData.captcha"}}),t("img",{attrs:{src:e.srcData,alt:""},on:{click:e.handleImgSrc}})],1)]):e._e(),8&e.sysConfig.resvmemo&&!e.isZju?t("el-form-item",{attrs:{label:e.$t("index_main_seatForm_description")}},[t("el-input",{attrs:{type:"textarea",placeholder:e.spaceDescription,maxlength:parseInt(e.sysConfig.resvmemolen),"show-word-limit":""},model:{value:e.formData.memo,callback:function(t){e.$set(e.formData,"memo",t)},expression:"formData.memo"}})],1):e._e()],1)],1)]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",size:"small",loading:e.submitLoading},on:{click:e.handleSubmit}},[e._v(e._s(e.$t("common_dialogButton_submit")))]),t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v(e._s(e.$t("common_dialogButton_cancel")))])],1)],1):e._e(),t("el-dialog",{staticClass:"notice_dialog",attrs:{title:e.$t("common_dialogAfter_title"),visible:e.dialogVisible_after,width:"480px","close-on-click-modal":!1,"append-to-body":!1},on:{"update:visible":function(t){e.dialogVisible_after=t}}},[t("p",[t("img",{attrs:{src:n("dcab"),alt:""}})]),t("p",[e._v(e._s(e.$t("common_seat_afterReserveDialog_success")))]),t("p",{staticStyle:{"word-break":"break-word"}},[e._v("\r\n        "+e._s(e.$t("common_seat_afterReserveDialog_lookInfo"))+"\r\n      ")]),t("p",{staticStyle:{"word-break":"break-word"}},[t("i",{staticClass:"el-icon-warning-outline"}),e._v("\r\n        "+e._s(e.$t("common_seat_afterReserveDialog_label1"))+"\r\n        "),t("span",{staticClass:"content cl"},[e.isZju?t("span",[e._v(e._s(e.SeatInfo.resvRule?e.SeatInfo.resvRule.cancelTime-2:"")+e._s(e.$t("common_unit_m")))]):t("span",[e._v(e._s(e.SeatInfo.resvRule?e.SeatInfo.resvRule.cancelTime:"")+e._s(e.$t("common_unit_m")))])]),e._v("\r\n        "+e._s(e.$t("common_seat_afterReserveDialog_label2"))+"\r\n      ")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible_after=!1}}},[e._v(e._s(e.$t("common_dialogButton_cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:e.hrefuserInfo}},[e._v(e._s(e.$t("common_dialogButton_confirm")))])],1)])],1)},V=[],L=(n("a481"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"time-wrapp"},[t("div",{staticClass:"line"}),e.boxInfo.timeArr?t("div",{staticClass:"lineItem-wrap"},e._l(e.boxInfo.timeArr,(function(n,a){return t("div",{key:a,staticClass:"line-item"},[t("span",[e._v(e._s(e.$moment(n).format("HH")))])])})),0):e._e(),t("div",{staticClass:"disable"},e._l(e.disableArr,(function(e,n){return t("div",{key:n,staticClass:"disable-item",style:"width:".concat(e.width,";left:").concat(e.left)})})),0),t("div",{staticClass:"disable-resv"},e._l(e.resvInfoArr,(function(e,n){return t("div",{key:n,staticClass:"disable-item",style:"width:".concat(e.width,";left:").concat(e.left)})})),0),t("div",{directives:[{name:"show",rawName:"v-show",value:e.newInfo.show,expression:"newInfo.show"}],staticClass:"newTime"},[t("div",{staticClass:"newItem",style:"width:".concat(e.newInfo.width,";left:").concat(e.newInfo.left)},[t("div",{staticClass:"newStartTip"},[e._v(e._s(e.newInfo.startTime))])])]),t("div",{staticClass:"nowTime"},[t("div",{staticClass:"nowItem",style:"width: ".concat(e.nowWidth)}),t("div",{staticClass:"maxTime",style:"left: ".concat(e.maxTime.left,"%;width: ").concat(e.maxTime.width,"%")})])])}),z=[],B={name:"",props:{reserveInfo:{type:Object,default:{}},dateValue:{type:Date,default:new Date},newInfo:{type:Object,default:{}}},data:function(){return{}},methods:{getLeft:function(e,t){var n=this.$moment().format("YYYY/MM/DD"),a=this.$moment("".concat(n," ").concat(this.$moment(t).format("HH:mm")))-this.$moment("".concat(n," ").concat(e));return"".concat(a/this.boxInfo.allTime*100,"%")},getWidth:function(e,t){var n=this.$moment(t)-this.$moment(e);return"".concat(n/this.boxInfo.allTime*100,"%")}},computed:{initData:function(){var e="",t="",n=[],a=[];if(this.reserveInfo.openTimes){if(this.reserveInfo.openStart&&(e=this.$moment(new Date("2019/09/03 ".concat(this.reserveInfo.openStart))).format("HH:00")),this.reserveInfo.openEnd){var i=this.$moment(new Date("2019/09/03 ".concat(this.reserveInfo.openEnd))).format("HH:00");t=+new Date("2019/09/03 ".concat(i))<+new Date("2019/09/03 ".concat(this.reserveInfo.openEnd))?this.$moment("2019/09/03 ".concat(i)).add(1,"hours").format("HH:00"):i,"00:00"==t&&(t="23:59")}var s=this.reserveInfo.openTimes;new Date("2019/07/23 ".concat(s[0].openStartTime))-new Date("2019/07/23 ".concat(e)>0)&&n.push({start:this.$moment(new Date("2019/07/23 ".concat(e))).format("YYYY/MM/DD HH:mm"),end:this.$moment(new Date("2019/07/23 ".concat(s[0].openStartTime))).format("YYYY/MM/DD HH:mm")});for(var r=0;r<s.length-1;r++)n.push({start:this.$moment(new Date("2019/07/23 ".concat(s[r].openEndTime))).format("YYYY/MM/DD HH:mm"),end:this.$moment(new Date("2019/07/23 ".concat(s[r+1].openStartTime))).format("YYYY/MM/DD HH:mm")});new Date("2019/07/23 ".concat(s[s.length-1].openEndTime))-new Date("2019/07/23 ".concat(t))<0&&n.push({start:this.$moment(new Date("2019/07/23 ".concat(s[s.length-1].openEndTime))).format("YYYY/MM/DD HH:mm"),end:this.$moment(new Date("2019/07/23 ".concat(t))).format("YYYY/MM/DD HH:mm")}),this.reserveInfo.resvInfo&&(a=this.reserveInfo.resvInfo.filter((function(e){return!(128&e.resvStatus)>0})))}return{startTime:e,endTime:t,disableTime:n,resvInfo:a}},boxInfo:function(){var e=[],t="";if(this.initData.startTime&&this.initData.endTime){for(var n=new Date("2019/09/03 ".concat(this.initData.startTime)),a=new Date("2019/09/03 ".concat(this.initData.endTime)),i=Math.ceil((a-n)/1e3/3600),s=0;s<=i-1;s++){var r=new Date(+new Date("2019/09/03 ".concat(this.initData.startTime))+60*s*60*1e3);e.push(r)}t=a-n}return{timeArr:e,allTime:t}},resvInfoArr:function(){var e=this,t=[];return this.initData.resvInfo&&(t=this.initData.resvInfo.map((function(t){var n=e.getLeft(e.initData.startTime,t.startTime),a=e.getWidth(t.startTime,t.endTime);return{left:n,width:a}}))),t},disableArr:function(){var e=this,t=[];if(this.boxInfo.allTime&&this.initData.disableTime&&this.initData.startTime){var n=[],a=this.initData.disableTime.map((function(t){var n=e.getLeft(e.initData.startTime,t.start),a=e.getWidth(t.start,t.end);return{left:n,width:a}}));t=[].concat(n,Object(c["a"])(a))}return t},showNowDate:function(){return this.$moment(this.dateValue).format("YYYY/MM/DD")===this.$moment().format("YYYY/MM/DD")},nowWidth:function(){var e=this.$moment(this.dateValue).format("YYYY/MM/DD"),t=this.reserveInfo.resvRule.latestResvTime,n=this.$moment().add(t,"minutes"),a=this.initData.startTime;if(this.$moment("".concat(e," ").concat(a,":00")).isBefore(n)&&t%1440!==0||0===t){var i=(n.toDate()-this.$moment("".concat(e," ").concat(a,":00")).toDate())/this.boxInfo.allTime*100;return i=i>100?100:i,i+"%"}return"0%"},maxTime:function(){var e={left:0,width:0},t=this.$moment(this.dateValue).format("YYYY/MM/DD"),n=this.reserveInfo.resvRule.earliestResvTime;if(n%1440!==0&&t===this.$moment().add(n,"minutes").format("YYYY/MM/DD")){var a=this.$moment().add(n,"minutes");e.left=(a.toDate()-this.$moment("".concat(t," ").concat(this.initData.startTime,":00")).toDate())/this.boxInfo.allTime*100,e.width=(this.$moment("".concat(t," ").concat(this.initData.endTime,":00")).toDate()-a.toDate())/this.boxInfo.allTime*100}return e}}},W=B,K=(n("79ae"),Object(y["a"])(W,L,z,!1,null,"4d04c282",null)),U=K.exports,q=n("5063"),X=n("2f62"),G=n("9e17");function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){Object(s["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Q={name:"SeatForm",props:{SeatInfo:{type:Object,default:{}},dateValue:{type:Date,default:new Date},selectedTimeObj:{type:Object,default:[]}},mixins:[f],data:function(){return{isShowTemporarilyleave:!1,Temporarilyleave:"",titleArr:[],formData:{title:"",startTime:"",endTime:"",captcha:"",memo:""},srcData:"".concat(window.g.ApiUrl,"/captcha?id=").concat(Date.now()),dialogVisible:!1,newInfo:{show:!1,width:"0%",left:"0%",startTime:"",endTime:""},noFreeSelectTime:"",submitLoading:!1,dialogVisible_after:!1,spaceDescription:"",endTimeArr:[],startTimeArr:[],notFreeTimeArr:[]}},watch:{dialogVisible:function(e,t){var n=this;if(e)if(this.getTempLeavedata(this.SeatInfo.devId),this.formData.title="",this.formData.memo="",this.formData.captcha="",this.SeatInfo&&this.SeatInfo.openTimes&&this.isNotFreelySelectTime(this.SeatInfo.openTimes)){this.noFreeSelectTime="",this.notFreeTimeArr=this.initFreeTimeArr(this.dateValue,this.SeatInfo);var a=this.selectedTimeObj,i=a.startTime,s=a.endTime,r="".concat(i," - ").concat(s);this.notFreeTimeArr.findIndex((function(e){return e.value===r}))>=0?this.noFreeSelectTime=r:this.notFreeTimeArr.length>0&&(this.noFreeSelectTime=this.notFreeTimeArr[0].value),this.formData.startTime=i,this.formData.endTime=s}else{this.SeatInfo.resvRule.minResvTime;if(this.judgLimit(this.SeatInfo,64))this.isOpen(this.SeatInfo,this.dateValue)?this.formData.startTime=this.$moment().format("HH:mm"):this.formData.startTime=this.openStart;else{var o=this.initStartTimeArr(this.dateValue,this.SeatInfo);this.startTimeArr=this.removeReserveInfo(o,this.SeatInfo);var l=this.selectedTimeObj.startTime,c=void 0===l?"":l;this.formData.startTime=c?this.startTimeArr.some((function(e){return e.value===c}))?c:this.startTimeArr[0].value:this.startTimeArr.length>0?this.startTimeArr[0].value:""}var m=this.initEndTimeArr(this.SeatInfo,this.formData.startTime,this.dateValue);this.endTimeArr=this.endTimeArrRemoveReserveInfo(m,this.SeatInfo,this.formData.startTime),this.judgLimit(this.SeatInfo,128)&&this.judgLimit(this.SeatInfo,64)?this.formData.endTime=this.SeatInfo.openEnd:this.endTimeArr.length>0&&this.selectedTimeObj.endTime&&this.endTimeArr.some((function(e){return e.value===n.selectedTimeObj.endTime}))?this.formData.endTime=this.selectedTimeObj.endTime:this.formData.endTime=this.endTimeArr.length>0?this.endTimeArr[this.endTimeArr.length-1].value:""}},"formData.startTime":function(e,t){var n=this;if(e){this.SeatInfo.openStart;var a=this.__initData__.startTime;this.newInfo.startTime=e;var i=new Date("2019/09/26 ".concat(e))-new Date("2019/09/26 ".concat(a));if(this.newInfo.left="".concat(i/this.allTimes*100,"%"),this.newInfo.endTime){var s=new Date("2019/09/26 ".concat(this.newInfo.endTime))-new Date("2019/09/26 ".concat(this.newInfo.startTime));this.newInfo.width="".concat(s/this.allTimes*100,"%")}else this.newInfo.width="0%";if(this.newInfo.show=!0,this.judgLimit(this.SeatInfo,128)&&this.judgLimit(this.SeatInfo,64))return;if(this.SeatInfo.openTimes.length>0&&(2&this.SeatInfo.openTimes[0].openLimit)>0)return;var r=this.initEndTimeArr(this.SeatInfo,e);this.endTimeArr=this.endTimeArrRemoveReserveInfo(r,this.SeatInfo,e),this.endTimeArr.length>0?this.endTimeArr.some((function(e){return e.value===n.formData.endTime}))||(this.formData.endTime=this.endTimeArr[this.endTimeArr.length-1].value):this.formData.endTime=""}else this.newInfo.show=!1},"formData.endTime":function(e,t){if(this.SeatInfo&&this.SeatInfo.openTimes&&!this.isNotFreelySelectTime(this.SeatInfo.openTimes)&&(!e||this.endTimeArr.length<=0))this.newInfo.endTime=this.newInfo.startTime,this.newInfo.width="0%";else{this.newInfo.endTime=e;var n=new Date("2019/09/26 ".concat(e))-new Date("2019/09/26 ".concat(this.newInfo.startTime));this.newInfo.width="".concat(n/this.allTimes*100,"%")}},"$i18n.locale":{handler:function(e,t){if(!((1&this.sysConfig.resvmemo)<0)){var n=this.sysConfig.resvmemotip||"",a=n.split("^");a.length>1?this.spaceDescription="en"===e?a[1]:a[0]:this.spaceDescription=a[0]}},immediate:!0},__initData__:{handler:function(e){},immediate:!0,deep:!0}},methods:{getTempLeavedata:function(e){var t=this,n={devId:e};Object(r["i"])({params:n}).then((function(n){if(0==n.code)if(n.data.length>0){var a=n.data[0],i=a[e],s=(new Date).getTime(),r=(i-s)/1e3,o=parseInt(r/86400),l=r-24*o*60*60,c=parseInt(l/3600),m=r-24*o*60*60-60*c*60,u=parseInt(m/60),d=parseInt(60*c+u);t.Temporarilyleave=0==d?1:d,window.g.isShowSeatLeavingTime&&(t.isShowTemporarilyleave=!0)}else t.isShowTemporarilyleave=!1}))},hrefuserInfo:function(){this.$router.replace({path:"/ic/userinfo"})},handleImgSrc:function(){this.srcData="".concat(window.g.ApiUrl,"/captcha?id=").concat(Date.now())},changeDialog:function(){this.dialogVisible=!this.dialogVisible},handleSubmit:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return e.$message.warning(e.$t("common_resvFailure_tip")),!1;e.$moment("".concat(e.$moment(e.dateValue).format("YYYY-MM-DD")," ").concat(e.formData.startTime,":00")).isBefore(e.$moment("".concat(e.$moment().format("YYYY-MM-DD HH:mm:ss"))))&&e.$moment(e.dateValue).format("YYYY/MM/DD")===e.$moment().format("YYYY/MM/DD")&&(e.formData.startTime=e.$moment().add(1,"minutes").format("HH:mm")),e.formData.endTime?(e.submitLoading=!0,Object(r["j"])({sysKind:8,appAccNo:e.userInfo.accNo,memberKind:1,resvMember:[e.userInfo.accNo],resvBeginTime:"".concat(e.$moment(e.dateValue).format("YYYY-MM-DD")," ").concat(e.formData.startTime,":00"),resvEndTime:"".concat(e.$moment(e.dateValue).format("YYYY-MM-DD")," ").concat(e.formData.endTime,":00"),testName:e.formData.title,captcha:e.formData.captcha,resvProperty:0,resvDev:[e.SeatInfo.devId],memo:e.formData.memo}).then((function(t){0===t.code?(e.$emit("reset",""),e.dialogVisible=!1,e.dialogVisible_after=!0):(e.handleImgSrc(),e.$message.error(t.message)),e.submitLoading=!1}))):e.$message({type:"warning",message:"必须选择结束时间"})}))},handleNotFreeTimeChange:function(e){if(e){var t=e.split("-");"当前时间"!==t[0].trim()&&"currentTime"!==t[0].trim()||(t[0]=this.$moment().format("HH:mm")),this.formData.startTime=t[0].trim(),this.formData.endTime=t[1].trim()}},getTitle:function(){var e=this;Object(G["h"])({params:{codeType:1005}}).then((function(t){0===t.code&&(e.titleArr=t.data.map((function(e){return{label:e.name,value:e.name}})))}))}},created:function(){this.isThemeInput||this.getTitle()},computed:Z(Z({},Object(X["e"])(["userInfo"])),{},{rules:function(){var e={captcha:[{required:!0,message:"该项不能为空",trigger:"blur"}]};return(8&this.sysConfig.resvthememust)>0&&0==(1024&this.SeatInfo.resvRule.limit)&&(e.title=[{required:!0,message:"该项不能为空",trigger:"blur"}]),e},allTimes:function(){return new Date("2019/09/26 ".concat(this.__initData__.endTime))-new Date("2019/09/26 ".concat(this.__initData__.startTime))},limit:function(){var e=this.SeatInfo.resvRule?this.SeatInfo.resvRule.limit:0,t=[{value:0,label:this.$t("index_main_resvInfo_limit_label1")},{value:1,label:this.$t("index_main_resvInfo_limit_label2")},{value:2,label:this.$t("index_main_resvInfo_limit_label3")},{value:4,label:this.$t("index_main_resvInfo_limit_label4")},{value:8,label:this.$t("index_main_resvInfo_limit_label5")},{label:this.$t("index_main_resvInfo_limit_label6"),value:16},{label:this.$t("index_main_resvInfo_limit_label7"),value:64},{label:this.$t("index_main_resvInfo_limit_label8"),value:128}];if(0!=e){var n=t.filter((function(t){return(t.value&e)>0})),a="";return n.forEach((function(e){a+="".concat(e.label,",")})),a}return this.$t("index_main_resvInfo_limit_label1")},earliestResvTime:function(){var e={d:"",h:"",m:""};return e.d=Math.floor(this.SeatInfo.resvRule.earliestResvTime/1440),e.h=Math.floor(this.SeatInfo.resvRule.earliestResvTime%1440/60),e.m=Math.floor(this.SeatInfo.resvRule.earliestResvTime%1440%60),e},latestResvTime:function(){var e={d:"",h:"",m:""};return e.d=Math.floor(this.SeatInfo.resvRule.latestResvTime/1440),e.h=Math.floor(this.SeatInfo.resvRule.latestResvTime%1440/60),e.m=Math.floor(this.SeatInfo.resvRule.latestResvTime%1440%60),e},openStart:function(){var e=this.SeatInfo,t=this.dateValue;return e?this.getOpenTime(e,t):""},closeTime:function(){return this.SeatInfo&&this.SeatInfo.openEnd},isShowReserveInfo:function(){var e=this.sysConfig.showResvRules||0;return(1&e)<=0},isThemeInput:function(){return(8&this.sysConfig.resvthemefix)>0}}),components:{SeatTimeBar:U,ResearchInfo:q["a"]}},ee=Q,te=(n("cab9"),Object(y["a"])(ee,F,V,!1,null,"089711fa",null)),ne=te.exports;function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(n),!0).forEach((function(t){Object(s["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var se={name:"SeatReserve",data:function(){return this.modes=[{label:this.$t("common_subSystem_pc"),value:1},{label:this.$t("common_subSystem_reserveDesk"),value:2},{label:this.$t("common_subSystem_mobile"),value:4}],{isShowSeatLeaving:window.g.isShowSeatLeavingTime,valObj:{},dateValue:new Date,timeValue:[],startTimeOptions:[],endTimeOptions:[],startTimeStr:"",endTimeStr:"",canSelectTime:[],LeaveTemporarilyOptions:[{value:"11",LeaveTemporarilyStr:"全部"},{value:"2",LeaveTemporarilyStr:"2min"},{value:"3",LeaveTemporarilyStr:"3min"},{value:"4",LeaveTemporarilyStr:"4min"},{value:"5",LeaveTemporarilyStr:"5min"},{value:"10",LeaveTemporarilyStr:"10min"}],LeaveTemporarilyStr:"",Temporarilyleave_data:[],circleSizeValue:12,options:[],isEdit:!1,isshowedit:"",SeatInfo:{},loading:!1,positionDownAndUp:{down:{x:0,y:0},up:{x:0,y:0}},allSeatProperties:[],checkedProps:[],isShowMask:!1,editOptions:[],editLoading:!1,noFreeSelectTime:"",notFreeTimeArr:[]}},mixins:[f],computed:ie({kindId:function(){return this.$route.params.roomIds},filteredOptions:function(){return this.options.filter((function(e){return e.isShow}))},isSuperMnger:function(){var e=this.userInfo.roleLevel;return 1===e||2===e||3===e},roomIds:function(){return this.$route.params.roomIds},isJudgLimit:function(){var e=this.options,t=e&&e.length>0?e[0]:null;return(128&(t&&t.resvRule&&t.resvRule.limit))>0},openStart:function(){var e=this.options,t=this.dateValue;return e&&Array.isArray(e)&&e.length>0?this.getOpenTime(e[0],t):""},closeTime:function(){var e=this.options,t=e&&e.length>0?e[0]:null;return t&&t.openEnd},isNotFreely:function(){return!(!this.options||!Array.isArray(this.options)||this.options.length<=0)&&this.isNotFreelySelectTime(this.options[0].openTimes)},selectedTimeObj:function(){var e={startTime:"",endTime:""};return this.timeValue.length>=2&&(e.startTime=this.$moment(this.timeValue[0]).format("HH:mm"),e.endTime=this.$moment(this.timeValue[1]).format("HH:mm")),e},pickerOptions:function(){var e=this;return{disabledDate:function(t){return new Date(e.$moment(t).format("YYYY-MM-DD"))-new Date(e.$moment(new Date).format("YYYY-MM-DD"))<0}}},isShowName:function(){return!(!this.options||this.options.length<=0)&&1==this.options[0].pointProperty}},Object(X["e"])({userInfo:function(e){return e.userInfo}})),watch:{kindId:{handler:function(e){this.getTemporarilyleave(this.kindId)},immediate:!0},isEdit:function(e,t){this.isshowedit=!e},roomIds:function(e,t){this.dateValue=new Date,this.isEdit=!1,this.handleGetSeat()},checkedProps:{handler:function(e){var t=this;this.options.forEach((function(e){t.$set(e,"isAttrsChecked",!1)}));var n=[];Array.isArray(this.options)&&this.options.length>0&&e.length>0?(n=this.options.filter((function(t){var n=t.deviceAttributes;return!(!n||!Array.isArray(n))&&(t.isShow&&e.every((function(e){return n.findIndex((function(t){return e===t.codeValue}))>=0})))})),n.forEach((function(e){e.isAttrsChecked=!0}))):n=[],n.length>0?this.isShowMask=!0:this.isShowMask=!1}},LeaveTemporarilyStr:{handler:function(e){var t=this;this.options.forEach((function(e){t.$set(e,"isAttrsChecked",!1)}));var n=[];Array.isArray(this.Temporarilyleave_data)&&Array.isArray(this.options)&&""!=e?(this.Temporarilyleave_data.map((function(e,a){var i,s;for(var r in e)s=e[r],i=r;t.options.map((function(e,a){if("yellowGreen"==e.className&&i==e.devId||"yellow"==e.className&&i==e.devId){var r=(new Date).getTime(),o=(s-r)/1e3,l=parseInt(o/86400),c=o-24*l*60*60,m=parseInt(c/3600),u=o-24*l*60*60-60*m*60,d=parseInt(u/60),h=parseInt(60*m+d);(t.LeaveTemporarilyStr>h||t.LeaveTemporarilyStr==h||0==h)&&n.push(e)}}))})),n.forEach((function(e){e.isAttrsChecked=!0}))):n=[],n.length>0?this.isShowMask=!0:this.isShowMask=!1}}},created:function(){this.getAllType(),this.handleGetSeat(),"0"!=this.userInfo.manager||1!=this.userInfo.roleLevel&&2!=this.userInfo.roleLevel&&3!=this.userInfo.roleLevel?this.isshowedit=!1:this.isshowedit=!0},methods:{getTemporarilyleave:function(e){var t=this,n={roomId:e};Object(r["i"])({params:n}).then((function(e){0==e.code&&e.data.length>0&&(t.Temporarilyleave_data=e.data)}))},modalBeforeCreate:function(e){this.positionDownAndUp.down.x=e.clientX,this.positionDownAndUp.down.y=e.clientY},modalCreated:function(e){this.positionDownAndUp.up.x=e.clientX,this.positionDownAndUp.up.y=e.clientY},handleDatePickerChange:function(e){this.handleGetSeat()},confirm:function(){this.$refs.seatForm.changeDialog()},sysNeedKnow:function(){var e=Object(u["f"])(this.sysConfig.needToKnow,"8");if(e){var t=this.sysConfig.needToKnow.split("-").map((function(e){return e.split(",")})),n=this.$route.params.roomIds,a=t.find((function(e){return"8"===e[0]})),i=parseInt(a[0]),s=parseInt(a[1]),r=parseInt(n);this.valObj=Object(u["d"])(i,s,r)}},handleClickItem:function(e){var t=this;if(!this.isEdit){var n=this.$moment().format("YYYY-MM-DD");this.dateValue&&(n=this.$moment(this.dateValue).format("YYYY-MM-DD"));var a=this.$moment().format("HH:mm:00");this.timeValue.length>0&&(a=this.$moment(this.timeValue[0]).format("HH:mm:00"));var i="".concat(n," ").concat(a),s=e.devId,o=e.resvRule,l={devId:s,classKind:8,resvRuleId:o.ruleId,chooseBeginTime:i,isConsole:!1};Object(r["b"])({params:l}).then((function(n){0===n.code?t.goReserve(e):t.$message({type:"warning",message:n.message})}))}},goReserve:function(e){if("gray"!==e.className)if("yellow"!==e.className)if(e.onlyView)this.$message({message:"该座位仅支持现场预约",type:"warning"});else{var t=Object(u["f"])(this.sysConfig.needToKnow,"8");t?(this.sysNeedKnow(),this.$refs.needKnow.dialog=!0):this.$refs.seatForm.changeDialog(),this.SeatInfo=e}else this.$message({type:"warning",message:"您选择的座位已有人占用或不满足最小预约时长"});else this.$message({message:"请在开馆时间内预约",type:"warning"})},handleNotFreeTimeChange:function(e){if(e){var t=this.returnFreeTime(e),n=this.$moment(this.dateValue).format("YYYY/MM/DD");this.timeValue=[],this.timeValue.push(this.$moment("".concat(n," ").concat(t.startTime)).toDate(),this.$moment("".concat(n," ").concat(t.endTime)).toDate()),this.refreshSeats()}},handleGetSeat:function(){var e=this,t=this.roomIds,n=this.$moment(this.dateValue).format("YYYYMMDD"),a=8;this.loading=!0,Object(r["h"])({params:{roomIds:t,resvDates:n,sysKind:a}}).then((function(t){if(e.loading=!1,0===t.code&&Array.isArray(t.data)){var n=Object(c["a"])(t.data);if(n.sort((function(e,t){var n=e["devSn"],a=t["devSn"];return n-a})),e.options=n.map((function(e){return(2&e.devProp)>0||e.onlyView?e.isShow=!0:e.isShow=!1,e})),e.isNotFreely?(e.notFreeTimeArr=e.initFreeTimeArr(e.dateValue,t.data[0]),e.notFreeTimeArr.length>0&&(e.noFreeSelectTime=e.notFreeTimeArr[0].value,e.handleNotFreeTimeChange(e.noFreeSelectTime))):e.timeCallback(t.data),e.refreshSeats(),e.checkedProps=[],t.data&&t.data.length>0){var a=t.data[0].pointSize||0;Object.keys(a).includes("1")&&(e.circleSizeValue=a["1"])}}else e.$message.error(t.message),e.options=[]}))},refreshSeats:function(){var e=this;this.options=this.options.map((function(t){var n=[],a="";if(e.isJudgLimit)a=e.handleItemCurrentClass(e.timeValue,e.dateValue,t);else{var i=e.mergeReserveInfo(t),s=e.formatDisablectData(e.dateValue,t);n=s.disableTime,n=[].concat(Object(c["a"])(n),Object(c["a"])(i)),a=e.handleItemClass(e.timeValue,n,t,e.dateValue)}return t.className=a,t}))},handleEditFalse:function(){this.isEdit=!1,this.handleGetSeat()},setAllShowedOptions:function(){this.options.forEach((function(e){2&e.devProp&&(e.isShow=!0)}))},handleEditTrue:function(){!(Array.isArray(this.options)&&this.options.length>0)||this.options[0].resvRule&&this.options[0].openTimes||this.setAllShowedOptions(),this.isSuperMnger&&(this.checkedProps=[],this.getEditSeatReserve())},getEditSeatReserve:function(){var e=this,t=this.roomIds,n=this.$moment(this.dateValue).format("YYYYMMDD"),a=8,i={roomIds:t,resvDates:n,sysKind:a};this.editLoading=!0,this.loading=!0,Object(r["c"])({params:i}).then((function(t){0===t.code?(e.isEdit=!0,t.data&&Array.isArray(t.data)?e.editOptions=t.data:e.editOptions=[]):e.$message({type:"error",message:t.message}),e.editLoading=!1,e.loading=!1}))},getSeatPosition:function(e,t,n){var a=this;n.stopPropagation();var i=document.getElementsByClassName("draggable"),s=document.querySelector(".grid"),o=s.offsetWidth,l=s.offsetHeight,c=Array.from(i).map((function(t){var n=e.find((function(e){return e.devName==t.title})),a="".concat((t.offsetLeft/o*100).toFixed(6)),i="".concat((t.offsetTop/l*100).toFixed(6));return{devId:n.devId,coordinate:"".concat(a,",").concat(i),devProp:n.devProp}}));e.forEach((function(e){if((2&e.devProp)<=0){var t=e.devId,n=e.coordinate,a=e.devProp;c.push({devId:t,coordinate:n,devProp:a})}}));var m,u=[];this.modes.forEach((function(e){m={},m.roomId=a.roomIds,m.type=e.value,t.checkList.includes(1)?m.property=1:m.property=0,1===e.value?m.size=t.pcCircleSize:2===e.value?m.size=t.consoleCircleSize:4===e.value&&(m.size=t.mCircleSize),u.push(m)}));var d={seatPoints:u,coordinates:c};this.loading=!0,Object(r["k"])(d).then((function(e){a.loading=!1,0===e.code?(a.isEdit=!1,a.$message.success(e.message),a.handleGetSeat()):a.$message.error(e.message)}))},timeCallback:function(e){if(e&&!(e.length<=0)&&e[0].resvRule&&e[0].openTimes){var t=e[0];this.startTimeOptions=this.initStartTimeArr(this.dateValue,t),this.startTimeOptions.length>0?this.startTimeStr=this.startTimeOptions[0].value:this.startTimeStr=t.openStart,this.endTimeOptions=this.initEndTimeArr(t,this.startTimeStr),this.setEndTimeStr(t),this.setTimeValue()}},setEndTimeStr:function(e){var t=this,n=this.startTimeStr,a=e.resvRule,i=a.minResvTime,s=a.maxResvTime,r=new Date("2019/09/03 ".concat(this.endTimeStr))-new Date("2019/09/03 ".concat(n));(!this.endTimeStr||r>60*s*1e3||r<60*i*1e3||this.endTimeStr&&this.endTimeOptions.every((function(e){return e.value!=t.endTimeStr})))&&(this.endTimeStr=this.endTimeOptions.length>0?this.endTimeOptions[this.endTimeOptions.length-1].value:this.startTimeStr)},setTimeValue:function(){var e=this.dateValue,t=this.$moment(e).format("YYYY/MM/DD"),n=this.$moment("".concat(t," ").concat(this.startTimeStr)).toDate(),a=this.$moment("".concat(t," ").concat(this.endTimeStr)).toDate();this.timeValue=[],this.timeValue.push(n),this.timeValue.push(a)},handleSltSTChange:function(e){var t=this.options[0];this.endTimeOptions=this.initEndTimeArr(t,e),this.setEndTimeStr(t),this.setTimeValue(),this.refreshSeats()},handleSltETChange:function(){this.setTimeValue(),this.refreshSeats()},getAllType:function(){var e=this,t={codeType:1010};Object(r["a"])({params:t}).then((function(t){0===t.code&&t.data&&Array.isArray(t.data)?e.allSeatProperties=t.data:e.allSeatProperties=[]}))},handleFullEdit:function(){var e=this.$router.resolve({path:"/fullEditSeats",query:{roomIds:this.roomIds,dateValue:this.dateValue}});window.open(e.href,"_blank")}},components:{SeatItem:T,SeatArea:x,SeatForm:ne,NeedKnow:m["a"],EditSeat:N}},re=se,oe=(n("5648"),Object(y["a"])(re,o,l,!1,null,"0c7c4eb4",null)),le=oe.exports,ce=function(){var e=this,t=e._self._c;return t("div",[e.isEdit?[t("EditSeat",{directives:[{name:"loading",rawName:"v-loading",value:e.editLoading,expression:"editLoading"}],attrs:{seatOptions:e.editOptions},on:{cancel:e.handleEditFalse,save:e.getSeatPosition}})]:[t("section",{staticClass:"seatOperation"},[t("span",[e._v("选择日期：")]),t("el-date-picker",{staticStyle:{"margin-top":"10px",width:"150px"},attrs:{type:"date",size:"small",clearable:!1,placeholder:"开始日期","picker-options":e.startPickerOptions},on:{change:e.handleStartDateChange},model:{value:e.dateValue.startDate,callback:function(t){e.$set(e.dateValue,"startDate",t)},expression:"dateValue.startDate"}}),e._v("\r\n        -\r\n        "),t("el-date-picker",{staticStyle:{"margin-top":"10px",width:"150px"},attrs:{type:"date",size:"small",clearable:!1,placeholder:"结束日期","picker-options":e.endPickerOptions},model:{value:e.dateValue.endDate,callback:function(t){e.$set(e.dateValue,"endDate",t)},expression:"dateValue.endDate"}}),e.isShowEdit?t("el-button",{style:{"margin-left":"10px"},attrs:{size:"small"},on:{click:e.handleEditTrue}},[e._v(e._s(e.$t("index_main_seat_editPane_edit")))]):e._e(),e.allSeatProperties.length>0&&!e.isEdit?t("div",{staticStyle:{"margin-top":"10px",display:"flex","align-items":"center"}},[t("span",{staticStyle:{"margin-right":"20px"}},[e._v("选择座位: ")]),t("el-checkbox-group",{model:{value:e.checkedProps,callback:function(t){e.checkedProps=t},expression:"checkedProps"}},e._l(e.allSeatProperties,(function(n){return t("el-checkbox",{key:n.codeValue,attrs:{label:n.codeValue}},[e._v(e._s(n.name))])})),1)],1):e._e()],1),t("div",{staticClass:"reserve-status"},[t("span",{staticClass:"free"},[e._v(e._s(e.$t("common_seatStatus_free")))]),t("span",{staticClass:"half_free"},[e._v(e._s(e.$t("common_seatStatus_halfFree")))]),t("span",{staticClass:"busy"},[e._v(e._s(e.$t("common_seatStatus_inUsing")))]),t("span",{staticClass:"noopen"},[e._v(e._s(e.$t("common_seatStatus_noOpen")))]),t("span",{staticClass:"noopenlook"},[e._v("网站不开放但可查看")])]),t("SeatArea",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{options:e.options,circleSizeValue:e.circleSizeValue,isEdit:e.isEdit,isShowMask:e.isShowMask,modalBeforeCreate:e.modalBeforeCreate,modalCreated:e.modalCreated},on:{handleClickItem:e.handleClickItem}}),e.seatInfo?t("SeatFormAcross",{ref:"seatFormAcross",attrs:{seatInfo:e.seatInfo,defaultDateRange:e.dateValue,startDatePickerOptions:e.startPickerOptions,endDatePickerOptions:e.endPickerOptions},on:{reset:e.handleGetSeat}}):e._e(),t("NeedKnow",{ref:"needKnow",attrs:{valObj:e.valObj},on:{confirm:e.confirm}})]],2)},me=[],ue=function(){var e=this,t=e._self._c;return t("div",[e.seatInfo?t("el-dialog",{staticClass:"seat-form",attrs:{visible:e.dialogVisible,title:e.$t("index_main_seatForm_title"),"close-on-click-modal":!1,width:"750px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",{staticClass:"data-box"},[e.seatInfo&&e.isShowReserveInfo?t("ResearchExamInfo",{attrs:{roomRules:e.seatInfo}}):e._e(),t("el-form",{ref:"formRef",attrs:{"label-width":"120px",model:e.formModel,rules:e.rules}},[e.isShowTheme&&0==(1024&e.seatInfo.resvRule.limit)?t("el-form-item",{staticClass:"w70",attrs:{label:"主题",prop:"title"}},[e.isInputTheme?t("el-input",{attrs:{size:"small"},model:{value:e.formModel.title,callback:function(t){e.$set(e.formModel,"title",t)},expression:"formModel.title"}}):t("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",placeholder:"请选择"},model:{value:e.formModel.title,callback:function(t){e.$set(e.formModel,"title",t)},expression:"formModel.title"}},e._l(e.titleArr,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),t("el-form-item",{attrs:{label:e.$t("index_main_seatForm_targetName")}},[e._v("\r\n          "+e._s(e.seatInfo.labName)),t("span",{staticClass:"info-tip"},[e._v("（楼）")]),e._v("\r\n          "+e._s(e.seatInfo.roomName)),t("span",{staticClass:"info-tip"},[e._v("（区）")]),e._v("\r\n          "+e._s(e.seatInfo.devName)),t("span",{staticClass:"info-tip"},[e._v("（座）")])]),t("el-form-item",{attrs:{label:e.$t("index_main_seatForm_applicant")}},[t("span",[e._v(e._s(e.userInfo.trueName)+" ("),t("span",[e._v(e._s(e.userInfo.logonName))]),e._v(")")])]),t("el-form-item",{attrs:{label:e.$t("index_main_seatForm_dateRange")}},[t("el-date-picker",{staticStyle:{width:"150px"},attrs:{type:"date",size:"small",clearable:!1,placeholder:"开始日期","picker-options":e.locateStartDatePickerOptions},on:{change:e.handleStartDateChange},model:{value:e.dateValue.startDate,callback:function(t){e.$set(e.dateValue,"startDate",t)},expression:"dateValue.startDate"}}),e._v(" ~\r\n          "),t("el-date-picker",{staticStyle:{width:"150px"},attrs:{type:"date",size:"small",clearable:!1,placeholder:"结束日期","picker-options":e.locateEndDatePickerOptions},model:{value:e.dateValue.endDate,callback:function(t){e.$set(e.dateValue,"endDate",t)},expression:"dateValue.endDate"}})],1),e.isShowResvCode?t("el-form-item",{attrs:{label:e.$t("common_placeholder_captcha"),prop:"captcha"}},[t("div",{staticClass:"code-wrapper"},[t("el-input",{staticStyle:{width:"30%"},attrs:{size:"small"},model:{value:e.formModel.captcha,callback:function(t){e.$set(e.formModel,"captcha",t)},expression:"formModel.captcha"}}),t("img",{attrs:{src:e.srcData,alt:""},on:{click:e.handleImgSrc}})],1)]):e._e(),e.isShowMemo?t("el-form-item",{attrs:{label:e.$t("index_main_seatForm_description"),prop:"memo"}},[t("el-input",{staticClass:"mt10",attrs:{type:"textarea",placeholder:e.spaceDescription,maxlength:parseInt(e.sysConfig.resvmemolen),"show-word-limit":""},model:{value:e.formModel.memo,callback:function(t){e.$set(e.formModel,"memo",t)},expression:"formModel.memo"}})],1):e._e()],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",size:"small",loading:e.submitLoading},on:{click:e.handleSubmit}},[e._v(e._s(e.$t("const_PcServe_text16")))]),t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v(e._s(e.$t("const_PcServe_text17")))])],1)]):e._e(),t("el-dialog",{staticClass:"notice_dialog",attrs:{title:e.$t("common_dialogAfter_title"),visible:e.dialogVisible_after,width:"480px","close-on-click-modal":!1,"append-to-body":!1},on:{"update:visible":function(t){e.dialogVisible_after=t}}},[t("p",[t("img",{attrs:{src:n("dcab"),alt:""}})]),t("p",[e._v(e._s(e.$t("common_seat_afterReserveDialog_success")))]),t("p",{staticStyle:{"word-break":"break-word"}},[e._v(e._s(e.$t("common_seat_afterReserveDialog_lookInfo")))]),t("p",{staticStyle:{"word-break":"break-word"}},[t("i",{staticClass:"el-icon-warning-outline"}),e._v("\r\n        "+e._s(e.$t("common_seat_afterReserveDialog_label1"))+"\r\n        "),t("span",{staticClass:"content cl"},[e.isZju?t("span",[e._v(e._s(e.seatInfo.resvRule?e.seatInfo.resvRule.cancelTime-2:"")+e._s(e.$t("common_unit_m")))]):t("span",[e._v(e._s(e.seatInfo.resvRule?e.seatInfo.resvRule.cancelTime:"")+e._s(e.$t("common_unit_m")))])]),e._v("\r\n        "+e._s(e.$t("common_seat_afterReserveDialog_label2"))+"\r\n      ")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible_after=!1}}},[e._v(e._s(e.$t("common_dialogButton_cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:e.hrefuserInfo}},[e._v(e._s(e.$t("common_dialogButton_confirm")))])],1)])],1)},de=[],he=n("e498");function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){Object(s["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ve={name:"SeatFormAcross",props:{seatInfo:{type:Object,default:function(){return{}}},defaultDateRange:{type:Object,default:function(){return{}}},startDatePickerOptions:{type:Object,default:function(){return{}}},endDatePickerOptions:{type:Object,default:function(){return{}}}},components:{ResearchExamInfo:he["a"]},data:function(){return this.fullDayStr="YYYY/MM/DD 00:00:00",{titleArr:[],submitLoading:!1,dialogVisible:!1,dateValue:{startDate:new Date(this.$moment().format(this.fullDayStr)),endDate:new Date(this.$moment().format(this.fullDayStr))},formModel:{title:"",captcha:"",memo:""},locateStartDatePickerOptions:{},locateEndDatePickerOptions:{},spaceDescription:"",srcData:"".concat(window.g.ApiUrl,"/captcha?id=").concat(Date.now()),dialogVisible_after:!1}},computed:pe(pe({},Object(X["e"])(["userInfo"])),{},{isShowMemo:function(){return(8&this.sysConfig.resvmemo)>0},isShowTheme:function(){return(8&this.sysConfig.resvTheme)>0},isInputTheme:function(){return(8&this.sysConfig.resvthemefix)>0},isThemeMust:function(){return(8&this.sysConfig.resvthememust)>0&&0==(1024&this.seatInfo.resvRule.limit)},isShowReserveInfo:function(){var e=this.sysConfig.showResvRules||0;return(8&e)<=0},isShowResvCode:function(){return"1"===this.sysConfig.resvCode},rules:function(){var e={};return this.isShowResvCode&&(e.captcha=[{required:!0,message:"该项不能为空",trigger:"blur"}]),this.isThemeMust&&(e.title=[{required:!0,message:"该项不能为空",trigger:"blur"}]),e}}),watch:{defaultDateRange:{handler:function(e){e&&(e.startDate&&(this.dateValue.startDate=e.startDate),e.endDate&&(this.dateValue.endDate=e.endDate))},immediate:!0,deep:!0},startDatePickerOptions:{handler:function(e){e&&(this.locateStartDatePickerOptions=e)},deep:!0,immediate:!0},endDatePickerOptions:{handler:function(e){e&&(this.locateEndDatePickerOptions=e)},deep:!0,immediate:!0},"$i18n.locale":{handler:function(e,t){if(this.isShowMemo){var n=this.sysConfig.resvmemotip||"",a=n.split("^");a.length>1?this.spaceDescription="en"===e?a[1]:a[0]:this.spaceDescription=a[0]}},immediate:!0}},methods:{hrefuserInfo:function(){this.$router.replace({path:"/ic/userinfo"})},changeDialog:function(){this.dialogVisible=!this.dialogVisible},handleSubmit:function(){var e=this;this.$refs.formRef.validate((function(t){if(!t)return e.$message.warning(e.$t("const_PcServe_text18")),!1;var n=e.dateValue,a=n.startDate,i=n.endDate,s={};e.$moment().format("YYYY/MM/DD")===e.$moment(a).format("YYYY/MM/DD")?s.resvBeginTime=Object(u["k"])(e.$moment().add(1,"m").format("YYYY/MM/DD HH:mm:00")):s.resvBeginTime=Object(u["k"])("".concat(e.$moment(a).format("YYYY/MM/DD")," 00:00:00")),s.resvEndTime="".concat(e.$moment(i).format("YYYY-MM-DD")," 23:59:59"),e.submitLoading=!0,Object(r["j"])({sysKind:8,appAccNo:e.userInfo.accNo,memberKind:1,resvMember:[e.userInfo.accNo],resvBeginTime:s.resvBeginTime,resvEndTime:s.resvEndTime,testName:e.formModel.title,captcha:e.formModel.captcha,resvProperty:32,resvDev:[e.seatInfo.devId],memo:e.formModel.memo}).then((function(t){0===t.code?(e.$emit("reset",""),e.dialogVisible=!1,e.dialogVisible_after=!0):(e.handleImgSrc(),e.$message.error(t.message)),e.submitLoading=!1}))}))},handleStartDateChange:function(e){this.setDateValueEndDate(this.seatInfo)},isFullDay:function(e){return"number"===typeof e&&e%1440===0},ceilDay:function(e){var t;return t=this.isFullDay(e)?Math.floor(e/1440):Math.floor(e/1440)+1,t},setDateValueEndDate:function(e){var t=this;if(e&&e.resvRule){var n=this.dateValue.startDate,a=e.resvRule,i=a.minResvTime,s=a.maxResvTime,r=this.ceilDay(i),o=this.ceilDay(s),l=this.$moment(n),c=this.$moment(l).add(r-1,"d").format("YYYY/MM/DD 00:00:00"),m=this.$moment(l).add(o-1,"d").format("YYYY/MM/DD 00:00:00");this.locateEndDatePickerOptions={disabledDate:function(e){var n=t.$moment(e);return n.isBefore(t.$moment(c))||n.isAfter(t.$moment(m))}},this.locateEndDatePickerOptions.disabledDate(this.dateValue.endDate)&&(this.dateValue.endDate=new Date(m))}else this.$message({type:"warning",message:"该座位没有匹配的预约规则"})},handleImgSrc:function(){this.srcData="".concat(window.g.ApiUrl,"/captcha?id=").concat(Date.now())},getTitle:function(){var e=this;Object(G["h"])({params:{codeType:1005}}).then((function(t){0===t.code&&(e.titleArr=t.data.map((function(e){return{label:e.name,value:e.name}})))}))}},created:function(){this.isInputTheme||this.getTitle()}},ge=ve,_e=(n("ebd7"),Object(y["a"])(ge,ue,de,!1,null,"671641a9",null)),ye=_e.exports;function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach((function(t){Object(s["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Se={name:"SeatAcrossReserve",components:{SeatArea:x,EditSeat:N,SeatFormAcross:ye,NeedKnow:m["a"]},data:function(){var e=this;return this.fullDayStr="YYYY/MM/DD 00:00:00",this.sysKind=8,{LeaveTemporarilyOptions:[{value:"11",LeaveTemporarilyStr:"全部"},{value:"2",LeaveTemporarilyStr:"2min"},{value:"3",LeaveTemporarilyStr:"3min"},{value:"4",LeaveTemporarilyStr:"4min"},{value:"5",LeaveTemporarilyStr:"5min"},{value:"10",LeaveTemporarilyStr:"10min"}],LeaveTemporarilyStr:"",Temporarilyleave_data:[],isShowSeatLeaving:window.g.isShowSeatLeavingTime,modes:[{label:this.$t("common_subSystem_pc"),value:1},{label:this.$t("common_subSystem_reserveDesk"),value:2},{label:this.$t("common_subSystem_mobile"),value:4}],dateValue:{startDate:new Date(this.$moment().format(this.fullDayStr)),endDate:new Date(this.$moment().format(this.fullDayStr))},startPickerOptions:{disabledDate:function(t){return new Date(e.$moment(t).format("YYYY/MM/DD"))-new Date(e.$moment().format("YYYY/MM/DD"))<0}},endPickerOptions:{disabledDate:""},circleSizeValue:12,isEdit:!1,options:[],loading:!1,editOptions:[],editLoading:!1,isShowMask:!1,allSeatProperties:[],checkedProps:[],positionDownAndUp:{down:{x:0,y:0},up:{x:0,y:0}},valObj:{},seatInfo:null}},computed:Te(Te({},Object(X["e"])({userInfo:function(e){return e.userInfo}})),{},{kindId:function(){return this.$route.params.roomIds},roomIds:function(){return this.$route.params.roomIds},isShowEdit:function(){return"0"==this.userInfo.manager}}),watch:{kindId:{handler:function(e){this.getTemporarilyleave(this.kindId)},immediate:!0},isEdit:function(e,t){this.isshowedit=!e},roomIds:function(e,t){this.isEdit=!1,this.handleGetSeat(this.timeCallback)},"dateValue.endDate":{handler:function(e){e&&this.handleGetSeat()}},checkedProps:{handler:function(e){var t=this;this.options.forEach((function(e){t.$set(e,"isAttrsChecked",!1)}));var n=[];Array.isArray(this.options)&&this.options.length>0&&e.length>0?(n=this.options.filter((function(t){var n=t.deviceAttributes;return!(!n||!Array.isArray(n))&&(t.isShow&&e.every((function(e){return n.findIndex((function(t){return e===t.codeValue}))>=0})))})),n.forEach((function(e){e.isAttrsChecked=!0}))):n=[],n.length>0?this.isShowMask=!0:this.isShowMask=!1}},LeaveTemporarilyStr:{handler:function(e){var t=this;this.options.forEach((function(e){t.$set(e,"isAttrsChecked",!1)}));var n=[];Array.isArray(this.Temporarilyleave_data)&&Array.isArray(this.options)&&""!=e?(this.Temporarilyleave_data.map((function(e,a){var i,s;for(var r in e)s=e[r],i=r;t.options.map((function(e,a){if("yellowGreen"==e.className&&i==e.devId||"yellow"==e.className&&i==e.devId){var r=(new Date).getTime(),o=(s-r)/1e3,l=parseInt(o/86400),c=o-24*l*60*60,m=parseInt(c/3600),u=o-24*l*60*60-60*m*60,d=parseInt(u/60),h=parseInt(60*m+d);(t.LeaveTemporarilyStr>h||t.LeaveTemporarilyStr==h||0==h)&&n.push(e)}}))})),n.forEach((function(e){e.isAttrsChecked=!0}))):n=[],n.length>0?this.isShowMask=!0:this.isShowMask=!1}}},created:function(){this.getAllType(),this.handleGetSeat(this.timeCallback)},methods:{getTemporarilyleave:function(e){var t=this,n={roomId:e};Object(r["i"])({params:n}).then((function(e){0==e.code&&e.data.length>0&&(t.Temporarilyleave_data=e.data)}))},modalBeforeCreate:function(e){this.positionDownAndUp.down.x=e.clientX,this.positionDownAndUp.down.y=e.clientY},modalCreated:function(e){this.positionDownAndUp.up.x=e.clientX,this.positionDownAndUp.up.y=e.clientY},getAllType:function(){var e=this,t={codeType:1010};Object(r["a"])({params:t}).then((function(t){0===t.code&&t.data&&Array.isArray(t.data)?e.allSeatProperties=t.data:e.allSeatProperties=[]}))},handleStartDateChange:function(e){this.setDateValueEndDate(this.options,e),this.setSeatItemClass()},handleGetSeat:function(e){var t=this,n=this.roomIds,a=this.sysKind,i="".concat(this.$moment(this.dateValue.startDate).format("YYYYMMDD"),",").concat(this.$moment(this.dateValue.endDate).format("YYYYMMDD"));this.loading=!0,this.options=[],Object(r["h"])({params:{roomIds:n,resvDates:i,sysKind:a}}).then((function(n){if(t.loading=!1,0===n.code){var a=Object(c["a"])(n.data);a.sort((function(e,t){var n=e["devSn"],a=t["devSn"];return n-a})),t.options=a.map((function(e){return(2&e.devProp)>0||e.onlyView?e.isShow=!0:e.isShow=!1,e})),e&&e(t.options),t.setSeatItemClass(),t.checkedProps=[]}else t.$message.error(n.message),t.options=[]}))},isFullDay:function(e){return"number"===typeof e&&e%1440===0},ceilDay:function(e){var t;return t=this.isFullDay(e)?Math.floor(e/1440):Math.floor(e/1440)+1,t},getStartPickerOptions:function(e,t){var n=this;return{disabledDate:function(a){var i=new Date(n.$moment(a).format("YYYY/MM/DD"));return i-new Date(e.format("YYYY/MM/DD"))<0||i-new Date(t.format("YYYY/MM/DD"))>0}}},getEndPickerOptions:function(e,t){var n=this;return{disabledDate:function(a){var i=new Date(n.$moment(a).format("YYYY/MM/DD"));return i-new Date(e.format("YYYY/MM/DD"))<0||i-new Date(t.format("YYYY/MM/DD"))>0}}},timeCallback:function(e){if(!(e.length<=0))if(e[0].resvRule){var t=this.dateValue,n=t.startDate,a=t.endDate,i=e[0].resvRule,s=i.latestResvTime,r=i.earliestResvTime,o=i.minResvTime,l=i.maxResvTime,c=this.ceilDay(s),m=this.ceilDay(r),u=this.ceilDay(o),d=this.ceilDay(l);n=this.$moment("".concat(this.$moment().format("YYYY/MM/DD"))).add(c,"d"),a=this.$moment("".concat(this.$moment().format("YYYY/MM/DD"))).add(m-1,"d"),this.startPickerOptions=this.getStartPickerOptions(n,a);var h=this.$moment(n).add(d-1,"d"),f=this.$moment(n).add(u-1,"d");this.endPickerOptions=this.getEndPickerOptions(f,h)}else this.$message({type:"warning",message:"该区域没有匹配的预约规则"})},setDateValueEndDate:function(e,t){if(!(e.length<=0))if(e[0].resvRule){var n=e[0].resvRule,a=n.minResvTime,i=n.maxResvTime,s=this.ceilDay(a),r=this.ceilDay(i),o=this.$moment(t),l=this.$moment(o).add(s-1,"d").format("YYYY/MM/DD 00:00:00"),c=this.$moment(o).add(r-1,"d").format("YYYY/MM/DD 00:00:00");this.endPickerOptions=this.getEndPickerOptions(this.$moment(l),this.$moment(c)),this.endPickerOptions.disabledDate(this.dateValue.endDate)?this.dateValue.endDate=new Date(c):this.handleGetSeat()}else this.$message({type:"warning",message:"该区域没有匹配的预约规则"})},setSeatItemClass:function(){var e=this;this.options=this.options.map((function(t){var n=e.handleItemClass(e.dateValue,t.resvInfo,t);return t.className=n,t}))},handleItemClass:function(e,t,n){var a=this;if(!n.resvRule||!n.openTimes)return n.isShow=!1,"gray";if(n.onlyView)return"noopenlook";var i="",s=n.resvRule,r=s.latestResvTime,o=s.earliestResvTime,l=this.ceilDay(r),c=this.ceilDay(o),m=this.$moment().format("YYYY/MM/DD 00:00:00"),u=this.$moment(m).add(l,"d"),d=this.$moment(m).add(c,"d"),h=new Date("".concat(this.$moment(e.startDate).format("YYYY/MM/DD")," 00:00:00")),f=new Date("".concat(this.$moment(e.endDate).format("YYYY/MM/DD")," 00:00:00"));return i=!this.$moment(h).isBetween(u,d,null,"[]")||this.endPickerOptions.disabledDate(this.dateValue.endDate)||n.openStart==n.openEnd?"gray":t.some((function(e){var t=a.$moment(a.$moment(e.startTime).format(a.fullDayStr)).toDate(),n=a.$moment(a.$moment(e.endTime).format(a.fullDayStr)).toDate();return t<=h&&n>=f}))?"yellow":t.length>=0&&t.some((function(e){return a.$moment(f).isBetween(a.$moment(e.startTime),a.$moment(e.endTime))||a.$moment(h).isBetween(a.$moment(e.startTime),a.$moment(e.endTime))||a.$moment(f).isSameOrAfter(a.$moment(e.endTime))||a.$moment(h).isSameOrBefore(a.$moment(e.startTime))}))?"yellowGreen":"green",i},handleClickItem:function(e){if(e.openStart!=e.openEnd){var t=e.devId,n=e.resvRule;this.sysKind,n.ruleId;this.seatInfo=e,this.goReserve(e)}else this.$message({message:"开始日不开放, 请选择其他开始日",type:"warning"})},goReserve:function(e){if(!this.isEdit)if("gray"!==e.className)if("yellow"!==e.className)if(e.onlyView)this.$message({message:"该座位仅支持现场预约",type:"warning"});else{var t=Object(u["f"])(this.sysConfig.needToKnow,"8");t?(this.sysNeedKnow(),this.$refs.needKnow.dialog=!0):this.$refs.seatFormAcross.changeDialog()}else this.$message({type:"warning",message:"您选择的座位已有人占用,不可预约"});else this.$message({message:"请在开馆时间内预约",type:"warning"})},confirm:function(){this.$refs.seatFormAcross.changeDialog()},sysNeedKnow:function(){if(this.sysConfig.needToKnow){var e=this.sysConfig.needToKnow.split("-").map((function(e){return e.split(",")})),t=this.$route.params.roomIds,n=e.find((function(e){return"8"===e[0]})),a=parseInt(n[0]),i=parseInt(n[1]),s=parseInt(t);this.valObj=Object(u["d"])(a,i,s)}else this.$message({type:"error",message:"系统错误, 请退出系统重新进入"})},handleEditFalse:function(){this.isEdit=!1,this.handleGetSeat(this.timeCallback)},handleEditTrue:function(){this.checkedProps=[],this.getEditSeatReserve()},getEditSeatReserve:function(){var e=this,t=this.roomIds,n=this.$moment(this.dateValue.startDate).format("YYYYMMDD"),a=8,i={roomIds:t,resvDates:n,sysKind:a};this.editLoading=!0,this.loading=!0,Object(r["c"])({params:i}).then((function(t){0===t.code?(e.isEdit=!0,t.data&&Array.isArray(t.data)?e.editOptions=t.data:e.editOptions=[]):e.$message({type:"error",message:t.message}),e.editLoading=!1,e.loading=!1}))},getSeatPosition:function(e,t,n){var a=this;n.stopPropagation();var i=document.getElementsByClassName("draggable"),s=document.querySelector(".grid"),o=s.offsetWidth,l=s.offsetHeight,c=Array.from(i).map((function(t){var n=e.find((function(e){return e.devName==t.title})),a="".concat((t.offsetLeft/o*100).toFixed(6)),i="".concat((t.offsetTop/l*100).toFixed(6));return{devId:n.devId,coordinate:"".concat(a,",").concat(i),devProp:n.devProp}}));e.forEach((function(e){if((2&e.devProp)<=0){var t=e.devId,n=e.coordinate,a=e.devProp;c.push({devId:t,coordinate:n,devProp:a})}}));var m,u=[];this.modes.forEach((function(e){m={},m.roomId=a.roomIds,m.type=e.value,t.checkList.includes(1)?m.property=1:m.property=0,1===e.value?m.size=t.pcCircleSize:2===e.value?m.size=t.consoleCircleSize:4===e.value&&(m.size=t.mCircleSize),u.push(m)}));var d={seatPoints:u,coordinates:c};this.loading=!0,Object(r["k"])(d).then((function(e){a.loading=!1,0===e.code?a.$message.success(e.message):a.$message.error(e.message)}))}}},De=Se,we=(n("699a"),Object(y["a"])(De,ce,me,!1,null,"2007783a",null)),Oe=we.exports,Ie=function(){var e=this,t=e._self._c;return t("div",{staticClass:"wrapp"},[t("div",{staticClass:"big"},[t("el-image",{staticStyle:{width:"100%",height:"100%"},attrs:{src:e.currentImg,fit:"contain"}},[t("div",{staticClass:"el-image errorbox",staticStyle:{width:"100%",height:"100%","text-align":"center","background-color":"#f9f9f9"},attrs:{slot:"error"},slot:"error"},[t("img",{staticStyle:{"margin-top":"15%"},attrs:{src:n("0669")}}),t("p",{staticStyle:{color:"#969696","margin-top":"2%"}},[e._v(e._s(e.$t("common_tip_noPhoto")))])])])],1),t("div",{staticClass:"smallList"},[t("div",e._l(e.imgList,(function(a,i){return t("div",{key:i,staticClass:"smallItem",on:{click:function(t){return e.setCurrentImg(i)}}},[t("el-image",{staticStyle:{width:"100%",height:"100%"},attrs:{src:a.src,fit:"contain"}},[t("div",{staticClass:"el-image errorbox",staticStyle:{width:"100%",height:"100%","text-align":"center","background-color":"#f9f9f9"},attrs:{slot:"error"},slot:"error"},[t("img",{staticStyle:{"margin-top":"15%"},attrs:{src:n("0669")}}),t("p",{staticStyle:{color:"#969696","margin-top":"2%"}},[e._v(e._s(e.$t("common_tip_noPhoto")))])])])],1)})),0)])])},Ye=[],$e=(n("4917"),n("1f2f")),xe={data:function(){return{imgList:[],currentImg:""}},methods:{setCurrentImg:function(e){this.currentImg=this.imgList[e].src}},created:function(){var e=this,t={sysType:2,sysValue:this.$route.params.roomIds,sysKind:4,status:2};Object($e["a"])({params:t}).then((function(t){if(0===t.code){if(t.data){var n=/<img.*?(?:>|\/>)/gi,a=t.data.content.match(n),i=/src=[\'\"]?([^\'\"]*)[\'\"]?/i;t=[];a.forEach((function(e){var n=e.match(i);t.push({src:n[1]})})),e.imgList=t,e.setCurrentImg(0)}}else e.$message.error(t.message)}))},computed:{roomIds:function(){return this.$route.params.roomIds}},watch:{roomIds:function(e){var t=this,n={sysType:2,sysValue:e,sysKind:4,status:2};Object($e["a"])({params:n}).then((function(e){if(0===e.code)if(e.data){var n=/<img.*?(?:>|\/>)/gi,a=e.data.content.match(n),i=/src=[\'\"]?([^\'\"]*)[\'\"]?/i;e=[];a.forEach((function(t){var n=t.match(i);e.push({src:n[1]})})),t.imgList=e,t.setCurrentImg(0)}else t.imgList=[],t.currentImg="";else t.$message.error(e.message)}))}}},Ae=xe,ke=(n("7906"),Object(y["a"])(Ae,Ie,Ye,!1,null,"7ec35073",null)),Me=ke.exports,Ce=n("dd6b"),je=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ql-container"},[t("div",{staticClass:"ql-editor",domProps:{innerHTML:e._s(e.con)}})])},Re=[];n("dda9");function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(n),!0).forEach((function(t){Object(s["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var He={props:{areaName:{type:String,default:""}},data:function(){return{con:""}},created:function(){},methods:{getInstroUI:function(e){var t=this;this.getInstroduce(e).then((function(e){if(e)t.con=e;else{var n="<div class='title'><h3>"+t.areaName+"<span></span></h3></div>";t.con=n}}))},getInstroduce:function(e){return new Promise((function(t,n){Object($e["a"])({params:{sysType:2,sysValue:e,sysKind:1,status:2}}).then((function(e){0===e.code&&e.data&&""!=e.data.content?t(e.data.content):t("")}))}))}},computed:Pe({kindId:function(){return this.$route.params.roomIds}},Object(X["e"])({newResearch:function(e){return e.newResearch}})),watch:{kindId:{handler:function(e){this.getInstroUI(e)},immediate:!0}}},Ne=He,Fe=(n("25a6"),Object(y["a"])(Ne,je,Re,!1,null,"0fac889e",null)),Ve=Fe.exports,Le=n("4ccf"),ze=n("90d4"),Be=n("3a56e");function We(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?We(Object(n),!0).forEach((function(t){Object(s["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):We(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ue={name:"seatPredetermine",data:function(){return{currentIndex:0,areaRules:[],acrossAreaRules:null,currentArea:null}},mixins:[Be["a"]],computed:Ke(Ke({},Object(X["e"])(["navSeatMenu"])),{},{kindId:function(){return this.$route.params.roomIds},tabList:function(){return[{index:0,title:this.$t("index_main_seat_tabTitle1")},{index:1,title:this.$t("index_main_seat_tabTitle2")}]},areaName:function(){return this.currentArea.name},isSpanDay:function(){return this.currentArea.spanDay}}),created:function(){},watch:{kindId:{handler:function(e){this.currentArea=this.getDefaultArea(this.navSeatMenu,"id",this.kindId),this.currentArea.spanDay?this.getSeatOpen(this.kindId):this.getSeatOpenScope(this.kindId)},immediate:!0}},methods:{changeTab:function(e){this.currentIndex=e.index},getSeatOpenScope:function(e){var t=this,n={roomId:e};Object(r["g"])({params:n}).then((function(e){0===e.code?t.areaRules=e.data:t.areaRules=null}))},getSeatOpen:function(e){var t=this,n={roomId:e};Object(r["f"])({params:n}).then((function(e){0===e.code?t.acrossAreaRules=e.data:t.acrossAreaRules=null}))}},components:{SeatReserve:le,SeatAcrossReserve:Oe,MyTabs:Ce["a"],ImgList:Me,SeatIntroduce:Ve,DayTimeInfo:Le["a"],DayInfo:ze["a"]}},qe=Ue,Xe=(n("0487"),Object(y["a"])(qe,a,i,!1,null,"a1c02988",null));t["default"]=Xe.exports},ac4d:function(e,t,n){n("3a72")("asyncIterator")},b176:function(e,t,n){"use strict";n("d209")},b980:function(e,t,n){},c0ab:function(e,t,n){},c74f:function(e,t,n){},cab9:function(e,t,n){"use strict";n("c74f")},d209:function(e,t,n){},d4c0:function(e,t,n){var a=n("0d58"),i=n("2621"),s=n("52a7");e.exports=function(e){var t=a(e),n=i.f;if(n){var r,o=n(e),l=s.f,c=0;while(o.length>c)l.call(e,r=o[c++])&&t.push(r)}return t}},d56d:function(e,t,n){},dcab:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABKCAYAAABEr1FoAAAG7klEQVR4nO2de7AWYxzHP+ccmaZBSDckk0s0LqkxCKOSSxK5NGYUMQjRPxiZEaakUzM1xmVMYkIREZJQRBfJdQxjULpokhCi2zlJdcxjvm/zzs7u++6+z+6z77KfmZ1zzr67z/N7n+/u73n2+f32OTVNTU34sf31C3z3W3I68CBwIrASuBuYlURFrmne/82KaqxpnN3XlakdgG+AfYCt+rkL6AF84soIF0QRo9ahXZeq0acB+wGjgTpgsEMbqg6XAtTpZwNg/N4fnv1Z5H1tFeNSgJnAFuBGYC0wUUK8lGEBztBWMS4FWCs3tFL9wQbgOmChQxuqDpcCGOYDR6kPaA88lYE28rJEd27x8LHw95KohbkWoMCWlOpNGv8xfQn2+o98cZcU+/xCg9dUWn9ad0COyO8AOyL7fC+5AHacaVtA7oJSJhcgZXIBUibrfYCZSb0IOEYzqys05fFZFdgWiqwK0BqYCpzv89kI4GXgeuDPFGyLRBZd0OHARwGNX+Ay4EPgYLemRSdrAhwNLAI6hTjWuKXFQEcHdlVMlgQ4VjOnh0U454gIgqVCVgQ4QY3fvoJzO+pO6JyAXdZkQYDuwHtAG4syDpGAx8VoVyykJUCtYsFzgV+K5tP9NjOkbBVDne2Ar8rU9TswBxhoM8MZhTSGoe0UhrQK5SXEgUA/bSZ4dAWwMckKXd8BLYC3q7TxvfQBTH7J3klW4loA85B0vOM6bTgFGJ5kBS4FMHUNdVhfXAxLsnCXAnSW/88anZTFkQguBYhjJJMW+ydVbz4dnTK5ACmTC5AyuQApkwuQMv9nAUya/I9pG+FSgH4O6yqFmXS7T0PLQzXVXU6Ic5IyxpUA9wN3OaqrFLv1foJ5O+dvHWdmSEeVOW9CUlMSLmZD66uk8XfpfYRnfD5bWeZcMzX9sCbmJsZpVNICjAfuTLiOMJjGvxqYHnBsqQB/MRMkQn1chiUpgDH29gTLD8sOYJDyhfwYFNHOsUAzuTFrkuoDRldR4w8s0fjXyCVFfVFwVFxu1SvAUuXT2HA2MDIO4yzZDlwCzA4oxkyNT7F4S3MM0M3WSK8ApwGnWpZ5RwzxVDNCWaVGrIQGpSwGvTF9CzDJ0k4j3G0W5/9L3C7IdFC9LctYrOy3I5WC6DdqKcU2wKyz8E7AMabRHokp6N7HtoBauZygt/6iuqPWMcRQhwDr9btZ0uBa4LGQ527WiGZRwOcjNIyMK+Ohre1FXFvmNo/qAmyTYY3rWOPZZy6EW0OMv03d55Z4bcj0S+Ms7fOyWQ93FWME6KUroviqKPzdK2LB5vb/0sKeFgF9UJP6lgcCztuozv/jgM/H6Gk8bqyWKSChYWhYdxHEcyUSakdqiZtiflXjfx5wznifc+Jikm05XgEWxrB0wBTLMjqVSagdq7vB3BU/Az2BL3yOq9HaREk9iU9TFp0V3ifhqC7Hj53AAOAtDWsroaNEMFf2dz7nT9RqKx8Ay30+N43/aIIpJTP1Aog1Sa6YZdaDeMMyC+4nifBthHNq5RpusKi3FC8AV+lC20OlK2YlOR1dGBLauKP2EbOa6+QCk2r8aUoq3hni2FAkHQ/YpkBM0ENRGExa+gLgpDLH1um9sSHxfoU9TNEzya44C3URkDFj+4uVil4pBwHv6l0BP5rJNVyZ0Hd4XD4/1sbHYUSsscQYPiwHSARvx26evF8ELk/Q/hGVLEUThqwF5VsC8xTZ6qCHtrkadWWSLL4nvC/wZBXYEQt5XlDK5AKkTC5AyuQCpIxLAbZWZQuEozGpgl2OgpYXLdqdJZYpuyIyYebTXN4BjRldpvjZJAsPI0CtAu0D9Mq/DfcqgJIVViimYEsXxQ4atc3RvrICtNQ6DWYK4FXFa2+2MGYd0D8jIqxWdkWDZTldlG9lJiWba+unfV3KCWBCgGcBX+vp0wSgH4q4ZIwXE7ftCkwGNlmUkxQbFHXrFiJpNwz1upBnK4uirX43++rLdcI99HOwwn4tNOPYXauhV8p6pYkP15o+bTSj6UdXxXVt+6sGJWStC/j8L4U4V9lmOngo5EkNlbgoUmcSx3qXE+AH/TQBjtf0P2Ao8SWiskPRrlIRr/ky3CaNcJtc34KY7I5CQcziC6jwPXaXu6rGaeg4TLOQJlb7CvCp4y8xVWHASubjzUrtfVNqfLQ4ieFpLd1vtie0b165O8C4nZPlKlopD2ZywgYH8bxyRqeXcFdeNqkjXZqSzSiW0FNJY8UJBr+ZDOswD2LL5DurgZmKx84IkQJpsibOS+Fu9bJaq66MLnrXzIRo7wG+z2I8YJaC/TOUi+rHGj232GTpxcnqoP8WldWFW40/N+Prm4ALNZIynZ25W41AxsemPvdUNlUF+Ae58FcXnX3s0QAAAABJRU5ErkJggg=="},e828:function(e,t,n){},ebd7:function(e,t,n){"use strict";n("2de5")},f490:function(e,t,n){"use strict";n("602c")},ffc2:function(e,t,n){"use strict";n("e828")}}]);